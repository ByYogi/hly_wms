# 好来运仓储管理系统数据字典

> **版本**: v1.0
> **日期**: 2017-12-04
> **编写者**: 黄书才
> **表数量**: 133个

---

## 📑 目录

- [1. 核心业务表](#1-核心业务表)
  - [1.1 仓库管理](#11-仓库管理)
  - [1.2 产品管理](#12-产品管理)
  - [1.3 库存管理](#13-库存管理)
  - [1.4 订单管理](#14-订单管理)
  - [1.5 安全库存](#15-安全库存)
- [2. 业务枚举值](#2-业务枚举值)
- [3. 完整表清单](#3-完整表清单)

---

## 1. 核心业务表

### 1.1 仓库管理

#### Tbl_Cargo_House（仓库表/区域大仓）

**用途**: 保存仓库数据

| 字段名 | 描述 | 类型 | 主键 | 可空 | 默认值 | 备注 |
|--------|------|------|------|------|--------|------|
| HouseID | 表主键 | Int | √ | No | | |
| Name | 仓库名称 | Varchar(50) | | No | | |
| HouseCode | 仓库代码 | Char(2) | | No | | 2位字符 |
| Person | 仓库联系人 | Varchar(50) | | Yes | | |
| Cellphone | 联系电话 | Char(11) | | No | | |
| Address | 仓库地址 | Varchar(200) | | Yes | | |
| Remark | 备注 | Varchar(300) | | Yes | | |
| DelFlag | 删除/作废标志 | Tinyint | | Yes | 0 | 0:正常 1:作废 |
| OP_DATE | 操作时间 | Datetime | | Yes | Getdate() | |

---

#### Tbl_Cargo_Area（仓库区域表）

**用途**: 保存仓库的分区域数据，支持父子层级结构

| 字段名 | 描述 | 类型 | 主键 | 可空 | 默认值 | 备注 |
|--------|------|------|------|------|--------|------|
| AreaID | 表主键 | Int | √ | No | | |
| Name | 区域名称 | Varchar(50) | | No | | |
| Code | 区域代码 | Varchar(4) | | No | | |
| HouseID | 所属仓库ID | Int | | No | | 外键→House |
| ParentID | 父区域ID | Int | | No | | 支持层级结构 |
| AreaType | 区域类型 | Tinyint | | Yes | | 1:前置仓 0:否 |
| IsShowStock | 是否显示库存 | Tinyint | | Yes | | |
| DeliveryArea | 配送区域范围 | Varchar(500) | | Yes | | |
| Remark | 备注 | Varchar(300) | | Yes | | |
| OP_DATE | 操作时间 | Datetime | | Yes | Getdate() | |

---

#### Tbl_Cargo_Container（货位表/容器表）

**用途**: 保存仓库的货位或容器数据

| 字段名 | 描述 | 类型 | 主键 | 可空 | 备注 |
|--------|------|------|------|------|------|
| ContainerID | 表主键 | Int | √ | No | |
| ContainerCode | 货位代码 | Varchar(20) | | No | 仓库代码+区域代码+四位数字+货位类型 |
| ContainerNum | 货位号 | Int | | Yes | 例：0012 |
| ContainerType | 货位类型 | Char(3) | | No | RCK/ULD/CAR/SHL/VIR |
| AreaID | 所在仓库区域ID | Int | | No | 外键→Area |
| MaxPiece | 可放最大件数 | Int | | Yes | |
| MaxWeight | 可放最大重量 | Decimal(11,2) | | Yes | |
| MaxVolume | 可放最大体积 | Decimal(11,2) | | Yes | |

**货位类型枚举**:
- `RCK`: 货架
- `ULD`: 板
- `CAR`: 拖车
- `SHL`: 放在地上
- `VIR`: 虚拟货位

**货位代码格式**: `仓库代码(2位) + 区域代码 + 四位数字 + 货位类型(3位)`
**示例**: `01A120001RCK` = 01仓 + A12区 + 0001号 + 货架

---

### 1.2 产品管理

#### Tbl_Cargo_Product（产品表）

**用途**: 产品信息表，保存产品属性（产品实例表）

| 字段名 | 描述 | 类型 | 主键 | 可空 | 备注 |
|--------|------|------|------|------|------|
| ProductID | 产品ID | Bigint | √ | No | |
| ProductName | 产品名称 | Varchar(50) | | No | |
| ProductCode | 产品编码 | Varchar(20) | | Yes | |
| GoodsName | 产品名称 | Varchar(200) | | Yes | |
| TypeID | 产品类型ID | Int | | No | 外键→ProductType |
| Model | 型号/商贸编码 | Varchar(20) | | No | |
| GoodsCode | 货品代码/富添盛编码 | Varchar(50) | | Yes | |
| Specs | 规格 | Varchar(50) | | Yes | |
| Figure | 轮胎花纹/长和编码 | Varchar(50) | | Yes | |
| LoadIndex | 载重指数 | Varchar(20) | | Yes | |
| SpeedLevel | 速度级别 | Varchar(2) | | Yes | |
| HouseID | 所属仓库ID | Int | | No | |
| SpecsType | 规格类型 | Varchar(1) | | Yes | |

**重要说明**:
- 这是产品**实例表**，同一ProductCode在不同仓库/批次会有多条记录
- 972,231条记录，但只有8,196个唯一ProductCode
- 平均每个ProductCode有118条重复记录

---

#### Tbl_Cargo_ProductSpec（产品规格数据表）

**用途**: 产品的规格数据表，规格花纹型号货品代码（产品主数据）

| 字段名 | 描述 | 类型 | 主键 | 可空 | 备注 |
|--------|------|------|------|------|------|
| SID | 主键 | Int | √ | No | |
| ProductCode | 产品编码 | Varchar(15) | | Yes | |
| TypeID | 产品类型ID | Int | | No | |
| Model | 型号 | Varchar(20) | | No | |
| GoodsCode | 货品代码 | Varchar(20) | | Yes | |
| Specs | 规格 | Varchar(50) | | Yes | |
| Figure | 轮胎花纹 | Varchar(50) | | Yes | |
| LoadIndex | 载重指数 | Varchar(20) | | Yes | |
| SpeedLevel | 速度级别 | Varchar(2) | | Yes | |
| TreadWidth | 胎面宽度 | Int | | Yes | |
| FlatRatio | 轮胎扁平比 | Int | | Yes | |
| HubDiameter | 轮毂直径 | Int | | Yes | |

**重要说明**:
- 这是产品**主数据表**，标准规格信息
- 13,067条记录
- 与Product表关系：1个Spec → N个Product实例

---

#### Tbl_Cargo_ProductType（产品类型表/品牌表）

**用途**: 产品分类和品牌管理

| 字段名 | 描述 | 类型 | 备注 |
|--------|------|------|------|
| TypeID | 类型ID | Int | 主键 |
| TypeName | 类型名称 | Varchar(50) | 品牌名 |
| ParentID | 父类型ID | Int | 支持层级 |

---

### 1.3 库存管理

#### Tbl_Cargo_ContainerGoods（产品在库库存表）

**用途**: 产品入库记录表，记录货物在货位上的库存

| 字段名 | 描述 | 类型 | 主键 | 可空 | 备注 |
|--------|------|------|------|------|------|
| ID | 表主键 | Bigint | √ | No | |
| InCargoID | 入库单号 | Varchar(10) | | No | |
| ContainerID | 货位ID | Int | | No | 外键→Container |
| TypeID | 产品类型ID | Int | | No | 外键→ProductType |
| ProductID | 货物产品ID | Bigint | | Yes | 外键→Product |
| Piece | 件数 | Int | | No | 在货位上的货物件数 |
| Weight | 重量 | Decimal(12,2) | | Yes | 本批货物的重量 |
| InHouseTime | 入库时间 | Datetime | | Yes | |
| OutHouseTime | 最新出库时间 | Datetime | | Yes | |
| IsPrintInCargo | 是否打印入库单 | Tinyint | | No | 0:默认没有 1:已打印 |
| OP_DATE | 操作日期 | Datetime | | Yes | Getdate() |
| Piece_DATE | 数量更新日期 | Datetime | | Yes | |
| Take_DATE | 最后盘点日期 | Datetime | | Yes | |

**重要业务规则**:
- ✅ 一个货物可以在多个货位上
- ✅ 一个货位也可以放多个货物

---

#### Tbl_Cargo_InContainerGoods（产品入库表）

**用途**: 产品入库记录表

---

#### Tbl_Cargo_OutContainerGoods（产品出库表）

**用途**: 产品出库记录表

---

### 1.4 订单管理

#### Tbl_Cargo_Order（订单表）

**用途**: 系统订单数据表，维护客户订单数据信息

| 字段名 | 描述 | 类型 | 可空 | 备注 |
|--------|------|------|------|------|
| OrderID | ID | Bigint | No | 主键 |
| OrderNo | 订单号(退货单) | Varchar(12) | Yes | 长沙仓库:CS 衡阳仓库:HY |
| OrderNum | 订单顺序号 | Int | No | |
| HAwbNo | 副单号 | Varchar(20) | Yes | 外部系统或公司单号 |
| LogisAwbNo | 物流公司运单号 | Varchar(30) | Yes | |
| LogisID | 物流公司ID | Int | Yes | 外键→Logistic |
| Piece | 总件数 | Int | Yes | |
| Weight | 总重量 | Numeric(12,3) | Yes | |
| Volume | 总体积 | Numeric(12,3) | Yes | |
| TransportFee | 销售收入 | Numeric(12,2) | Yes | |
| DeliveryFee | 物流运输费用 | Numeric(12,2) | Yes | |
| TotalCharge | 合计总收入 | Numeric(12,2) | Yes | |
| **TrafficType** | **订单类型** | Tinyint | Yes | 0:内部订单 1:外采订单 2:提货外采 |
| **CheckOutType** | **结算方式** | Tinyint | Yes | 见下方枚举 |
| **DeliveryType** | **送货方式** | Tinyint | Yes | 0:送货 1:自提 2:快递 |
| **DeliverySettlement** | **物流结算** | Varchar(1) | Yes | 0:现付 1:到付 |
| **ThrowGood** | **退货标志** | Tinyint | Yes | 用于区分正常订单和退货 |
| OrderModel | 订单模式 | Tinyint | Yes | |
| CreateDate | 创建日期 | Datetime | Yes | |

**CheckOutType枚举（结算方式）**:
- `0`: 现付
- `1`: 回单
- `2`: 月结
- `3`: 到付
- `4`: 代收款
- `5`: 微信付款
- `6`: 额度付款
- `7`: 现金
- `8`: 周结
- `9`: 半月结
- `10`: 预付款

---

#### Tbl_Cargo_OrderGoods（客户订单与产品关联表）

**用途**: 订单明细表

---

#### Tbl_Cargo_FactoryOrder（工厂来货订单/采购订单）

**用途**: 来货订单数据表

| 字段名 | 描述 | 类型 | 可空 | 备注 |
|--------|------|------|------|------|
| ID | 主键 | Bigint | No | 自增长 |
| FacOrderNo | 工厂来货订单号 | Varchar(32) | No | |
| FacName | 工厂名称 | Varchar(100) | Yes | |
| **OrderType** | **订单类型** | Tinyint | No | 0:内部 1:外部 2:退货 3:外采 |
| HouseID | 所属仓库ID | Int | No | |
| ProductID | 产品ID | Varchar(10) | Yes | |
| ProductCode | 产品编码 | Varchar(20) | Yes | |
| Source | 产品来源 | Tinyint | Yes | |
| ProductName | 产品名称 | Varchar(50) | No | |
| OrderNum | 订单数量 | Int | Yes | |
| ReplyNumber | 回复数量 | Int | Yes | |
| InPiece | 入库件数 | Int | Yes | |
| **InCargoStatus** | **入库状态** | Tinyint | Yes | 0或2为在途 |
| BelongMonth | 订单归属月 | Varchar(6) | Yes | 格式:201812 |
| Born | 生产地 | Varchar(1) | Yes | 0:国产 1:进口 |
| ETATime | 预计到货时间 | Datetime | Yes | |
| ActualArrivalTime | 实际到货时间 | Datetime | Yes | |

**重要业务规则**:
- 采购在途计算：`InCargoStatus = 0 OR InCargoStatus = 2`
- 在途数量：`ReplyNumber - InPiece`

---

#### Tbl_Cargo_MoveOrder（移库订单表）

**用途**: 产品移库记录数据表

| 字段名 | 描述 | 类型 | 可空 | 备注 |
|--------|------|------|------|------|
| ID | 表主键 | Bigint | No | |
| MoveNo | 移库订单号 | Varchar(20) | No | |
| OldHouseName | 原仓库 | Varchar(50) | No | |
| OldHouseID | 原仓库ID | Int | No | |
| NewHouseName | 目标仓库 | Varchar(50) | No | |
| NewHouseID | 目标区域大仓ID | Int | No | |
| NewAreaID | 目标仓库ID | Int | Yes | |
| MoveNum | 移库数量 | Int | No | 移库的件数 |
| **MoveStatus** | **移库状态** | Tinyint | Yes | 见下方枚举 |
| Memo | 移库备注 | Varchar(500) | Yes | |
| OPID | 操作人 | Varchar(10) | No | |
| OP_DATE | 操作时间 | Datetime | No | |

**MoveStatus枚举（移库状态）**:
- `0`: 已开单
- `1`: 全扫描
- `2`: 已完成
- `3`: 移库中
- `4`: 入库中

**重要业务规则**:
- 移库在途计算：`MoveStatus <> 2`（未完成的移库单）

---

#### Tbl_Cargo_MoveOrderGood（移库订单明细表）

**用途**: 记录订单里的多份品名记录信息

| 字段名 | 描述 | 类型 | 备注 |
|--------|------|------|------|
| MoveNo | 移库订单号 | Varchar(20) | |
| ProductID | 产品ID | Bigint | |
| ContainerGoodsID | 库存ID | Bigint | |
| ContainerID | 货位ID | Bigint | |
| Piece | 出库件数 | Int | |
| NewPiece | 已入库件数 | Int | |

**重要业务规则**:
- 移库在途数量：`Piece - NewPiece > 0`

---

### 1.5 安全库存

#### Tbl_Cargo_SafeStock（安全库存数据表）

**用途**: 保存安全库存配置信息

| 字段名 | 描述 | 类型 | 主键 | 可空 | 默认值 | 备注 |
|--------|------|------|------|------|--------|------|
| SID | 表主键 | Bigint | √ | No | | |
| HouseID | 区域大仓ID | Int | | No | | |
| AreaID | 仓库ID（区域） | Int | | No | | |
| TypeID | 产品类型ID | Int | | No | | |
| ProductCode | 产品编码 | Varchar(30) | | Yes | | |
| GoodsCode | 货品代码 | Varchar(20) | | Yes | | |
| Specs | 规格 | Varchar(50) | | Yes | | |
| Figure | 轮胎花纹 | Varchar(50) | | Yes | | |
| LoadIndex | 载重指数 | Int | | Yes | 0 | |
| SpeedLevel | 速度级别 | Varchar(2) | | Yes | | |
| **StockNum** | **安全库存数量** | Int | | No | 0 | **= OEStock + HCYCStock + REStock** |
| **MinStock** | **最小库存** | Int | | Yes | 0 | = (月均销量/30) * 最小库存天数 |
| **MaxStock** | **最大库存** | Int | | Yes | 0 | = (月均销量/30) * 最大库存天数 |
| **MinStockDay** | **最小库存天数** | Int | | Yes | 0 | |
| **MaxStockDay** | **最大库存天数** | Int | | Yes | 0 | |
| **OEStock** | **OE安全库存数** | Int | | Yes | 0 | |
| **HCYCStock** | **云仓安全库存数** | Int | | Yes | 0 | |
| **REStock** | **RE安全库存数** | Int | | Yes | 0 | |
| **IsolatedStock** | **隔离库存数** | Int | | Yes | 0 | |
| **ControlStock** | **品控库存数** | Int | | Yes | 0 | |
| OPID | 操作员 | Varchar(30) | | Yes | | |
| OP_DATE | 操作时间 | Datetime | | Yes | Getdate() | |

**重要业务公式**:
```
安全库存数量 = OE安全库存数 + 云仓安全库存数 + RE安全库存数
最小库存 = (月均销量 / 30) * 最小库存天数  (向下取整)
最大库存 = (月均销量 / 30) * 最大库存天数  (向下取整)
日均销量 = 月均销量 / 30  (四舍五入取整)
库存度天数 = (在库数量 + 在途数量) / (月均销量 / 30)  (向下取整)
可调拨数(ExcessNum) = 在库库存 + 在途库存 - 安全库存
补货数量(LessNum) = 安全库存 - 在库库存 - 在途库存  (<=0时为0)
```

---

#### Tbl_Cargo_DailySaleStatic（日销量统计表）

**用途**: 每日销售数据统计

| 字段名 | 描述 | 类型 | 备注 |
|--------|------|------|------|
| SalesDate | 销售日期 | Date | |
| ProductCode | 产品编码 | Nvarchar(100) | |
| TypeID | 产品类型ID | Int | |
| HouseID | 仓库ID | Int | |
| AreaID | 区域ID | Int | |
| Piece | 销售件数 | Int | |
| WXPiece | 微信销售件数 | Int | |
| LastUpdateTime | 最后更新时间 | Datetime | |

**说明**: 306,044条记录

---

#### Tbl_Cargo_MonthSaleStatic（月销量统计表）

**用途**: 每月销售数据统计和加权月均销量计算

| 字段名 | 描述 | 类型 | 备注 |
|--------|------|------|------|
| YearMonth | 年月 | Datetime | 格式：2024-01-01 |
| ProductCode | 产品编码 | Varchar | |
| HouseID | 仓库ID | Int | |
| AreaID | 区域ID | Int | |
| TypeID | 产品类型ID | Int | |
| SumLast3Months | 最近3个月总销量 | Int | |
| WeightedMonthSale | 加权月均销量 | Numeric | |

**月均销量计算公式**:
```
月均销量 = n * 0.5 + (n-1) * 0.3 + (n-2) * 0.2
其中：
  n: 当月总销量
  n-1: 上月总销量
  n-2: 上上月总销量
```

---

## 2. 业务枚举值

### 订单相关

#### TrafficType（订单类型）
- `0`: 内部订单
- `1`: 外采订单
- `2`: 提货外采

#### CheckOutType（结算方式）
- `0`: 现付
- `1`: 回单
- `2`: 月结
- `3`: 到付
- `4`: 代收款
- `5`: 微信付款
- `6`: 额度付款
- `7`: 现金
- `8`: 周结
- `9`: 半月结
- `10`: 预付款

#### DeliveryType（送货方式）
- `0`: 送货
- `1`: 自提
- `2`: 快递

#### DeliverySettlement（物流结算）
- `0`: 现付
- `1`: 到付

#### ThrowGood（退货标志）
- `25`: 退货单（在查询销量时需排除）

---

### 采购订单相关

#### OrderType（工厂订单类型）
- `0`: 内部订单
- `1`: 外部订单
- `2`: 退货订单
- `3`: 外采订单

#### InCargoStatus（入库状态）
- `0`: 未入库（在途）
- `2`: 部分入库（在途）
- 其他: 已入库

#### Born（生产地）
- `0`: 国产
- `1`: 进口

---

### 移库订单相关

#### MoveStatus（移库状态）
- `0`: 已开单
- `1`: 全扫描
- `2`: 已完成
- `3`: 移库中
- `4`: 入库中

---

### 货位相关

#### ContainerType（货位类型）
- `RCK`: 货架
- `ULD`: 板
- `CAR`: 拖车
- `SHL`: 放在地上
- `VIR`: 虚拟货位

---

### 通用标志

#### DelFlag（删除/作废标志）
- `0`: 正常
- `1`: 作废

#### AreaType（区域类型）
- `0`: 普通仓库
- `1`: 前置仓

---

## 3. 完整表清单

### 3.1 供应商管理（3个）
1. `Tbl_Cargo_Supplier` - 供应商数据表
2. `Tbl_Cargo_SuppUser` - 供应商员工用户数据表
3. `Tbl_Cargo_SuppClient` - 供应商渠道客户数据表

### 3.2 仓库管理（11个）
4. `Tbl_Cargo_House` - 仓库表
5. `Tbl_Cargo_Area` - 仓库区域表
6. `Tbl_Cargo_Container` - 货位表或容器表
7. `Tbl_Cargo_ContainerStar` - 货位星级表
8. `Tbl_Cargo_ContainerGoods` - 产品在库库存表
9. `Tbl_Cargo_InContainerGoods` - 产品入库表
10. `Tbl_Cargo_OutContainerGoods` - 产品出库表
11. `Tbl_Cargo_MoveContainer` - 移库数据表
12. `Tbl_Cargo_MoveOrder` - 移库订单表
13. `Tbl_Cargo_MoveOrderGood` - 移库订单明细表
14. `Tbl_Cargo_SafeStock` - 安全库存数据表
15. `Tbl_Cargo_HouseBanner` - 慧采云仓广告Banner表
16. `Tbl_Cargo_StockTakeFile` - 盘点单附件表

### 3.3 产品管理（15个）
17. `Tbl_Cargo_Product` - 产品表
18. `Tbl_Cargo_ProductSpec` - 产品规格数据表
19. `Tbl_Cargo_SupplierPrice` - 供应商产品价格数据表
20. `Tbl_Cargo_ProductTag` - 产品标签出入库关系表
21. `Tbl_Cargo_ProductSource` - 产品来源数据表
22. `Tbl_Cargo_Shelves` - 商品上架数据表
23. `Tbl_Cargo_ProductFile` - 产品照片表
24. `Tbl_Cargo_SpeedLevel` - 轮胎速度等级表
25. `Tbl_Cargo_Car` - 车型分类
26. `Tbl_Cargo_CarTyreMatch` - 车型和轮胎匹配表
27. `Tbl_Cargo_StockSnap` - 库存快照表
28. `Tbl_Cargo_ProductAccessCount` - 访问计数表
29. `Tbl_Cargo_ProductBasicPrice` - 产品基础价格数据表
30. `Tbl_Cargo_ProductPrice` - 产品销售价格表
31. `Tbl_Cargo_ProductMapping` - 产品编码绑定映射数据表

### 3.4 客户管理（11个）
32. `Tbl_Cargo_UpClient` - 上游公司客户数据表
33. `Tbl_Cargo_UpClientDep` - 上游公司客户部门数据表
34. `Tbl_Cargo_Client` - 客户表
35. `Tbl_Cargo_AcceptAddress` - 客户收货地址管理
36. `Tbl_Cargo_InvoiceHeader` - 客户发票抬头数据表
37. `Tbl_Cargo_PostAddress` - 发票邮寄地址数据表
38. `Tbl_Cargo_ClientFile` - 客户资料照片数据表
39. `Tbl_Cargo_ClientPreRecord` - 客户预收款记录表
40. `Tbl_Cargo_InComeMoney` - 来款数据记录表
41. `Tbl_Cargo_ClientAccount` - 客户账单数据表
42. `Tbl_Cargo_Ageing` - 客户时效数据表

### 3.5 微信商城（13个）
43. `Tbl_WX_Address` - 微信用户地址数据表
44. `Tbl_WX_Point` - 积分记录数据表
45. `Tbl_WX_Order` - 微信订单表
46. `Tbl_WX_OrderProduct` - 订单产品关联数据表
47. `Tbl_WX_Coupon` - 优惠券数据表
48. `Tbl_WX_SecKill` - 活动领取表
49. `Tbl_WX_SecStatis` - 参与活动统计表
50. `Tbl_Taobao_Order` - 微信商城与淘宝订单关联数据表
51. `Tbl_Taobao_CashBack` - 淘宝订单返现和提成记录
52. `Tbl_Cargo_Behavior` - 小程序用户行为数据表
53. `Tbl_WX_MpNews` - 微信消息图文数据表
54. `Tbl_Cargo_Notice` - 商城公告数据表
55. `Tbl_Cargo_TryePic` - 轮胎图片路径关系表

### 3.6 订单管理（20个）
56. `Tbl_Cargo_Order` - 订单表
57. `Tbl_Cargo_OrderGoods` - 客户订单与产品关联表
58. `Tbl_Cargo_OrderStatus` - 订单状态跟踪表
59. `Tbl_Cargo_OrderPush` - 订单推送数据表
60. `Tbl_Cargo_FactoryFile` - 工厂来货订单单据文件表
61. `Tbl_Cargo_OrderTemp` - 订单删除记录表
62. `Tbl_Cargo_OrderGoodsTemp` - 客户删除订单与产品关联表
63. `Tbl_Cargo_OrderPickPlan` - 拣货计划数据表
64. `Tbl_Cargo_OrderPickPlanGoods` - 拣货计划明细数据表
65. `Tbl_Cargo_Bundle` - 捆包数据结构表
66. `Tbl_Cargo_BundleGoods` - 捆包单明细数据表
67. `Tbl_Cargo_Account` - 账单表
68. `Tbl_Cargo_PreOrder` - 富添盛预下单表
69. `Tbl_Cargo_PreOrderGoods` - 富添盛预下单明细表
70. `Tbl_Cargo_ReserveOrder` - 预订单表
71. `Tbl_Cargo_ReserveOrderGoods` - 预订单明细表
72. `Tbl_Cargo_ReserveOrderPaymentRecord` - 预订单支付明细表
73. `Tbl_Cargo_ReserveProcurementOrder` - 预订单采购明细表
74. `Tbl_Cargo_AreaClient` - 业务员负责区域客户表
75. `Tbl_Cargo_MobileCode` - 手机发送验证码数据记录表

### 3.7 物流管理（5个）
76. `Tbl_Cargo_Logistic` - 物流公司表
77. `Tbl_Cargo_HouseLogisPoll` - 仓库物流订阅表
78. `Tbl_Cargo_LogisLine` - 物流线路管理数据表
79. `Tbl_Cargo_LogisLineClient` - 物流线路客户绑定数据表
80. `Tbl_Cargo_HouseCityMapp` - 仓库与城市订单映射数据表

### 3.8 财务管理（15个）
81. `Tbl_Cargo_RecordAwbID` - 财务收支记录ID与关联费用ID关系表
82. `Tbl_Cargo_FirstSubject` - 财务报销二级科目数据表
83. `Tbl_Cargo_SecondSubject` - 财务报销三级科目数据表
84. `Tbl_Cargo_Expense` - 报销申请表
85. `Tbl_Cargo_ExpenseDetail` - 财务报销详细清单表
86. `Tbl_Cargo_ExpenseOrderID` - 财务报销与订单关联表
87. `Tbl_Cargo_ExpenseApproveSet` - 报销流程审批设置表
88. `Tbl_Cargo_ExpenseApproveRout` - 报销审批路线图表
89. `Tbl_Cargo_Payment` - 付款申请书数据表
90. `Tbl_Cargo_ReceiveInfo` - 收款人信息数据表
91. `Tbl_Cargo_PayPrintInfo` - 付款申请书打印记录表
92. `Tbl_Cargo_ApproveCheck` - 申请审批关联表
93. `Tbl_Cargo_Approve` - 申请表
94. `Tbl_Cargo_ApproveRelate` - 申请关联数据表
95. `Tbl_Cargo_ApproveFile` - 申请关联文件表

### 3.9 统计报表（10个）
96. `Tbl_Cargo_MonthStatis` - 每月总统计表
97. `Tbl_Cargo_WxMallStatis` - 微信商城销售统计
98. `Tbl_Cargo_DayCargoStock` - 每天仓库库存数据表
99. `Tbl_Cargo_PriceModify` - 产品价格修改异常记录数据表
100. `Tbl_Cargo_CityAgeing` - 城市时效数据表
101. `Tbl_Cargo_RuleBank` - 优惠规则库数据表
102. `Tbl_Cargo_HouseBrandPrice` - 仓库品牌加价数据表
103. `Tbl_Cargo_DailySaleStatic` - 日销量统计表
104. `Tbl_Cargo_MonthSaleStatic` - 月销量统计表
105. `Tbl_Cargo_SyncPriceLog` - 基础价格同步日志表

### 3.10 企业微信（11个）
106. `Tbl_QY_Config` - 企业号配置数据表
107. `Tbl_QY_Depart` - 企业号部门表
108. `Tbl_QY_User` - 企业员工信息表
109. `Tbl_QY_Tag` - 企业标签信息表
110. `Tbl_QY_OrderUpdatePrice` - 订单价格修改申请表
111. `Tbl_QY_OrderUpdateGoods` - 订单修改申请明细表
112. `Tbl_QY_PushConfig` - 企业号推送配置表
113. `Tbl_QY_CheckinData` - 企业员工打卡数据表
114. `Tbl_QY_CheckinDayReport` - 企业员工打卡日报数据表
115. `Tbl_QY_CheckinDayReportSpInfo` - 企业员工打卡日报假勤详细数据表
116. `Tbl_QY_CheckinMonthlyReport` - 企业员工打卡月报数据表
117. `Tbl_QY_CheckinRule` - 企业微信打卡规则表

### 3.11 APP管理（3个）
118. `Tbl_App_Version` - 商城APP版本更新表
119. `Tbl_App_AppleCheck` - 苹果APP提审表
120. `Tbl_Cargo_PushData` - 定时推送微信订单通知

### 3.12 第三方对接（13个）

#### 对外开放
121. `Tbl_Open_BasicProduct` - 对外开放外部系统使用产品基础数据表

#### 马牌(Continental)对接
122. `Tbl_Cargo_ContiOrderPush` - 马牌订单同步数据表
123. `Tbl_Cargo_ContiOrder` - 马牌订单数据表
124. `Tbl_Cargo_ContiOrderGoods` - 马牌订单产品关联数据表
125. `Tbl_Cargo_ContiOutOrderPush` - 马牌出库单数据同步表

#### 开思(CassMall)对接
126. `Tbl_Cargo_CassMallOrder` - 开思订单数据表
127. `Tbl_Cargo_CassMallOrderGoods` - 开思订单关联数据表
128. `Tbl_Cargo_CassMallOrderItemInventories` - 开思订单详情-头条目发货信息表
129. `Tbl_Cargo_CassMallOrderGiftItems` - 开思订单详情-订单赠品条目表
130. `Tbl_Cargo_CassMallOrderPostalAddress` - 开思订单详情-订单配送信息表
131. `Tbl_Cargo_CassMallOrderWayDetails` - 开思订单详情-订单配送物流信息表
132. `Tbl_Cargo_CassMallOrderItemAdjustments` - 开思订单条目优惠表
133. `Tbl_Cargo_CassMallOrderBuyer` - 开思订单买家信息表
134. `Tbl_Cargo_CassMallOrderSeller` - 开思订单卖家信息表
135. `Tbl_Cargo_CassMallOrderFulfillStore` - 开思订单履约店铺信息表

---

## 4. 重要业务关系

### 4.1 库存层级关系
```
Tbl_Cargo_House (区域大仓)
    ↓
Tbl_Cargo_Area (仓库区域, 支持ParentID层级)
    ↓
Tbl_Cargo_Container (货位)
    ↓
Tbl_Cargo_ContainerGoods (在库库存)
```

### 4.2 产品数据关系
```
Tbl_Cargo_ProductSpec (产品规格主数据, 13k条)
    ↓ 1:N
Tbl_Cargo_Product (产品实例, 972k条)
    ↓
Tbl_Cargo_ContainerGoods (库存记录)
```

### 4.3 在途库存计算
```sql
-- 采购在途
SELECT ProductCode, HouseID, SUM(ReplyNumber - InPiece) AS Piece
FROM Tbl_Cargo_FactoryOrder
WHERE (InCargoStatus = 0 OR InCargoStatus = 2)
  AND OrderType <> 2
GROUP BY ProductCode, HouseID

-- 移库在途
SELECT ProductCode, NewHouseID AS HouseID, SUM(Piece - NewPiece) AS Piece
FROM Tbl_Cargo_MoveOrderGood mg
INNER JOIN Tbl_Cargo_MoveOrder m ON mg.MoveNo = m.MoveNo
INNER JOIN Tbl_Cargo_Product p ON mg.ProductID = p.ProductID
WHERE m.MoveStatus <> 2
  AND Piece - NewPiece > 0
GROUP BY ProductCode, NewHouseID

-- 合计在途 = 采购在途 + 移库在途
```

### 4.4 当前库存计算
```sql
-- 在库库存
SELECT ProductCode, HouseID, SUM(Piece) AS Piece
FROM Tbl_Cargo_ContainerGoods cg
INNER JOIN Tbl_Cargo_Product p ON cg.ProductID = p.ProductID
INNER JOIN Tbl_Cargo_Container c ON cg.ContainerID = c.ContainerID
WHERE p.SpecsType != 5
GROUP BY ProductCode, HouseID
```

### 4.5 销量统计关系
```
Tbl_Cargo_Order (订单表)
    ↓
Tbl_Cargo_OrderGoods (订单明细)
    ↓ 汇总
Tbl_Cargo_DailySaleStatic (日销量)
    ↓ 汇总
Tbl_Cargo_MonthSaleStatic (月销量)
```

---

## 5. 性能优化建议

### 5.1 常用索引
```sql
-- Product表
CREATE INDEX IX_Product_Code_House ON Tbl_Cargo_Product(ProductCode, HouseID)

-- ContainerGoods表
CREATE INDEX IX_ContainerGoods_Product ON Tbl_Cargo_ContainerGoods(ProductID, ContainerID)

-- DailySaleStatic表
CREATE INDEX IX_DailySale_Date_Product ON Tbl_Cargo_DailySaleStatic(SalesDate, ProductCode, HouseID)

-- MonthSaleStatic表
CREATE INDEX IX_MonthSale_YearMonth ON Tbl_Cargo_MonthSaleStatic(YearMonth, ProductCode, HouseID)
```

### 5.2 查询优化要点
1. **Product表去重**: 使用 `ROW_NUMBER() OVER (PARTITION BY ProductCode, HouseID ORDER BY ProductID)` 避免笛卡尔积
2. **在途库存拆分**: 分别查询采购在途和移库在途，在代码中合并，避免UNION ALL
3. **月均销量查询**: 只按 `ProductCode, HouseID` 分组，不要包含 TypeID 和 AreaID
4. **销量排除退货**: `WHERE ThrowGood != 25 AND OrderModel = 0`

---

## 6. 常见问题

### Q1: 为什么Product表有972k条记录，但只有8k个ProductCode？
**A**: Product表是产品**实例表**，同一ProductCode在不同仓库、不同批次会有多条记录。ProductSpec表才是产品规格主数据。

### Q2: 如何计算在途库存？
**A**: 在途库存 = 采购在途 + 移库在途
- 采购在途：`FactoryOrder` 表中 `InCargoStatus = 0 或 2` 且 `OrderType <> 2`
- 移库在途：`MoveOrder` 表中 `MoveStatus <> 2`

### Q3: 安全库存数量是如何计算的？
**A**: `StockNum = OEStock + HCYCStock + REStock`

### Q4: 月均销量的权重是如何计算的？
**A**: `月均销量 = 当月 * 0.5 + 上月 * 0.3 + 上上月 * 0.2`

### Q5: 如何区分正常订单和退货单？
**A**: 查看 `ThrowGood` 字段，值为 `25` 表示退货单

---

## 7. 附录

### 7.1 表命名规范
- `Tbl_Cargo_*`: 货运仓储相关表
- `Tbl_WX_*`: 微信相关表
- `Tbl_QY_*`: 企业微信相关表
- `Tbl_Taobao_*`: 淘宝相关表
- `Tbl_App_*`: APP相关表
- `Tbl_Open_*`: 对外开放接口表

### 7.2 字段命名规范
- 主键通常为表名简写 + `ID`（如 `HouseID`, `AreaID`）
- 时间字段通常以 `_DATE` 或 `Time` 结尾
- 标志位字段通常为 `Is*` 或 `*Flag`
- 操作人字段通常为 `OPID` 或 `OP_Name`

### 7.3 数据类型约定
- ID主键: `Int` 或 `Bigint`
- 编码: `Varchar(10-50)`
- 名称: `Varchar(50-200)`
- 金额: `Numeric(12,2)`
- 重量/体积: `Decimal(12,2)` 或 `Numeric(12,3)`
- 日期: `Datetime` 或 `Date`
- 标志位: `Tinyint`

---

**文档生成时间**: 2024年
**最后更新**: 基于原始数据字典 v1.0 (2017-12-04)
**维护说明**: 此文档为简化版，详细字段说明请参考原始Word文档
