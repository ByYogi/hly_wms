<%@ Page Title="产品管理" Language="C#" MasterPageFile="~/Site.Master" AutoEventWireup="true" CodeBehind="productManager.aspx.cs" Inherits="Cargo.Product.productManager" %>

<asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server">
    <script src="../JS/Lodop/LodopFuncs.js" type="text/javascript"></script>
    <script type="text/javascript">
        //页面加载显示遮罩层
        var pc;
        var LogiName =<%=UserInfor.LoginName%>;
        var IsLockStock = null;
        $.ajax({
            url: "productApi.aspx?method=IsLockWarehouse",
            async: false,
            data: { LogiName: LogiName },
            type: "post",
            success: function (data) {
                var obj;
                if ((typeof data == 'object') && data.constructor == Object) {
                    obj = data;
                } else {
                    obj = eval("(" + data + ")");
                    //alert(obj)
                }
                IsLockStock = obj.userEnt.IsLockStock
            }
        })
        $.parser.onComplete = function () {
            if (pc) {
                clearTimeout(pc);
            }
            pc = setTimeout(closemask, 10);
            if (IsLockStock == 0) {
                $("#IsLockStock").css('display', 'none')
            }

        }
        //关闭加载中遮罩层
        function closemask() {
            $("#Loading").fadeOut("normal", function () {
                $(this).remove();
            });
        }
        //页面加载时执行
        window.onload = function () {
            $.ajaxSetup({ async: true });
            $.getJSON("../Client/clientApi.aspx?method=QueryAllUpClientDep", function (data) {
                UpClientDep = data;
            });
            $("#TypeID").combobox({
                //相当于html >> select >> onChange事件  
                onChange: function () {
                    var typeID = $('#TypeID').combobox('getValue');
                    if (typeID == 9) {
                        $("#Born").combobox('options').required = true;
                        $("#Born").combobox('textbox').validatebox('options').required = true;
                        $("#Born").combobox('validate');
                        $("#Assort").combobox('options').required = true;
                        $("#Assort").combobox('textbox').validatebox('options').required = true;
                        $("#Assort").combobox('validate');
                    } else {
                        $("#Born").combobox('options').required = false;
                        $("#Born").combobox('textbox').validatebox('options').required = false;
                        $("#Born").combobox('validate');
                        $("#Assort").combobox('options').required = false;
                        $("#Assort").combobox('textbox').validatebox('options').required = false;
                        $("#Assort").combobox('validate');
                    }
                }
            });
            $("#ParentID").combobox({
                //相当于html >> select >> onChange事件  
                onChange: function () {
                    //油品
                    $('#Y1').show(); $('#Y2').show(); $('#Y3').show(); $('#Y4').show(); $('#Y5').show(); $('#Y6').show(); $('#Y7').show(); $('#Y8').show(); $('#Y9').show(); $('#Y10').show(); $('#Y11').show(); $('#Y12').show(); $('#Y13').show(); $('#Y15').show(); $('#Y16').show(); $('#Y17').show(); $('#Y19').show(); $('#Y18').show(); $('#Y20').show();
                    var ParentID = $('#ParentID').combobox('getValue');
                    if (ParentID == "1") {
                        var _options = jQuery("#LoadIndex").textbox("options");
                        _options.required = true;
                        $('#LoadIndex').textbox(_options);
                        $("#SpeedLevel").combobox('options').required = true;
                        $("#SpeedLevel").combobox('textbox').validatebox('options').required = true;
                        $("#SpeedLevel").combobox('validate');
                    }
                    else if (ParentID == "35") {
                        //油品
                        $('#Y1').hide(); $('#Y2').hide(); $('#Y3').hide(); $('#Y4').hide(); $('#Y5').hide(); $('#Y6').hide(); $('#Y7').hide(); $('#Y8').hide(); $('#Y9').hide(); $('#Y10').show(); $('#Y11').hide(); $('#Y15').hide(); $('#Y16').hide(); $('#Y17').show(); $('#Y19').show(); $('#Y18').hide();
                        $('#lSpecs').html("油品系列:");
                        $('#lGoodsCode').html("油品代码:");
                        $('#lModel').html("油品型号:");
                        $('#lFigure').html("级别包装:");
                    }
                    else if (ParentID == "400" || ParentID == "401" || ParentID == "486" || ParentID == "494") {

                        //一二三汽配仓库
                        $('#lGoodsCode').html("产品编码:");
                        $('#GoodsCode').textbox({ prompt: '请输入产品编码' });

                        $('#lUnitPrice').html("基准价");
                        $('#lTradePrice').html("成本价");
                        $('#Y1').hide();
                        $('#Y2').hide();
                        $('#Y3').hide();
                        $('#Y4').hide();
                        $('#Y5').hide();
                        $('#Y6').hide();
                        $('#Y7').hide();
                        $('#Y8').hide();
                        $('#Y9').hide();
                        $('#Y10').hide();
                        $('#Y11').hide();
                        $('#Y12').hide();
                        //$('#Y27').hide();
                        $('#Y15').hide();
                        $('#Y19').hide();
                        $('#Y20').hide();
                        $('#Y22').hide();
                        $('#Y23').hide();
                        $('#Y25').hide();
                        $('#Y26').hide();

                        $('#Y17').show();
                        $('#Y13').show();
                        $('#Y18').hide();
                        $('#Y24').show();
                        var _options = jQuery("#Specs").textbox("options");
                        _options.required = false;
                        $('#Specs').textbox(_options);
                        _options = jQuery("#Model").textbox("options");
                        _options.required = false;
                        $('#Model').textbox(_options);
                        _options = jQuery("#Figure").textbox("options");
                        _options.required = false;
                        $('#Figure').textbox(_options);
                        $("#Source").combobox('options').required = false;
                        $("#Source").combobox('textbox').validatebox('options').required = false;
                        $("#Source").combobox('validate');
                    }
                    else {
                        var _options = jQuery("#LoadIndex").textbox("options");
                        _options.required = false;
                        $('#LoadIndex').textbox(_options);
                        $("#SpeedLevel").combobox('options').required = false;
                        $("#SpeedLevel").combobox('textbox').validatebox('options').required = false;
                        $("#SpeedLevel").combobox('validate');
                        $("#Born").combobox('options').required = false;
                        $("#Born").combobox('textbox').validatebox('options').required = false;
                        $("#Born").combobox('validate');
                        $("#Assort").combobox('options').required = false;
                        $("#Assort").combobox('textbox').validatebox('options').required = false;
                        $("#Assort").combobox('validate');
                    }
                }
            });
            adjustment();
            $.ajaxSetup({ async: true });
            $.getJSON("../Product/productApi.aspx?method=QueryAllProductSource", function (data) {
                ProductSource = data;
            });

            var url = '../Client/clientApi.aspx?method=QueryAllUpClientDep&type=1&houseID=<%=UserInfor.HouseID%>';
            $('#ABelongDepart').combobox('reload', url);
            $('#ABelongDepart').combobox('select', '-1');
            <%--var url = '../Client/clientApi.aspx?method=QueryAllUpClientDep&houseID=<%=UserInfor.HouseID%>';
            $('#BelongDepart').combobox('reload', url);--%>
        }
        $(window).resize(function () {
            adjustment();
        });
        function adjustment() {
            var height = Number($(window).height()) - $("div[name='SelectDiv1']").outerHeight(true);
            $('#dg').datagrid({ height: height });
        }
        $(document).ready(function () {
            var columns = [];
            var HID = '<%=UserInfor.HouseID%>';
            $('#HiddenHouseID').val(HID);
            if (HID == "47") {
                $("#AModelTd").html("商贸编码:");
                $('#AModel').textbox({ prompt: '请输入商贸编码' });
                $("#AFigureTd").html("长和编码:");
                $('#AFigure').textbox({ prompt: '请输入长和编码' });
                $("#AGoodsCodeTd").html("富添盛编码:");
                $('#AGoodsCode').textbox({ prompt: '请输入富添盛编码' });
                //$("#ASpecsTd").html("祺航编码:");
                //$('#ASpecs').textbox({ prompt: '请输入祺航编码' });
                $("td.ATagCodeTd").hide();
                $("td.ASpeedLevelTd").hide();
                $("td.ALoadIndexTd").hide();
                $("td.ABelongDepartTd").hide();
                //$("td.ProductIDTd").hide();
                //富添盛仓库
                columns.push({
                    title: '', field: '', checkbox: true, width: '30px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '产品ID', field: 'ProductID', width: '50px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                //columns.push({
                //    title: '区域大仓', field: 'HouseName', width: '80px', formatter: function (value) {
                //        return "<span title='" + value + "'>" + value + "</span>";
                //    }
                //});
                columns.push({
                    title: '所在仓库', field: 'AreaName', width: '80px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '一级类型', field: 'ParentName', width: '80px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '二级类型', field: 'TypeName', width: '60px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '富添盛编码', field: 'GoodsCode', width: '80px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '商贸编码', field: 'Model', width: '110px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '长和编码', field: 'Figure', width: '100px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '祺航编码', field: 'Size', width: '100px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '产品名称', field: 'ProductName', width: '150px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '规格', field: 'Specs', width: '80px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '货位代码', field: 'ContainerCode', width: '80px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '库存', field: 'RealStockNum', width: '40px', align: 'right', styler: function (val, row, index) { return "color:#12bb1f;font-weight:bold;" }, formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '单位', field: 'Package', width: '40px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '成本价', field: 'TradePrice', width: '60px', align: 'right', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '数量', field: 'Numbers', width: '60px', align: 'right', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '入库类型', field: 'OperaType', width: '60px', formatter: function (val, row, index) {
                        if (val == "0") { return "<span title='电脑入库'>电脑入库</span>"; }
                        else if (val == "1") { return "<span title='扫描入库'>扫描入库</span>"; } else { return "<span title='电脑入库'>电脑入库</span>"; }
                    }
                });
                columns.push({
                    title: '入库状态', field: 'InCargoStatus', width: '60px', formatter: function (val, row, index) {
                        if (val == "0") { return "<span title='未入库'>未入库</span>"; }
                        else if (val == "1") { return "<span title='已入库'>已入库</span>"; } else { return "<span title='未入库'>未入库</span>"; }
                    }
                });
                columns.push({ title: '入库时间', field: 'InHouseTime', width: '130px', formatter: DateTimeFormatter });
                columns.push({
                    title: '在库天数', field: 'InHouseDay', width: '65px', align: 'right', styler: function (val, row, index) { return "color:#85C1E9;font-weight:bold;" }, formatter: function (val, row, index) {
                        return getDateStr(row.InHouseTime);
                    }
                });
                columns.push({ title: '操作时间', field: 'OP_DATE', width: '130px', formatter: DateTimeFormatter });
            }
            else if (HID == "62") {
                $("#ASpecsTd").html("背番:");
                $('#ASpecs').textbox({ prompt: '请输入背番' });
                $("#AGoodsCodeTd").html("品番:");
                $('#AGoodsCode').textbox({ prompt: '请输入品番' });
                $("td.ATagCodeTd").hide();
                $("td.AModel").hide();
                $("td.AFigureTd").hide();
                $("td.ASpeedLevelTd").hide();
                $("td.ALoadIndexTd").hide();
                $("td.ABelongDepartTd").hide();
                $("td.ABelongDepartTd").hide();

                columns.push({
                    title: '', field: '', checkbox: true, width: '30px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '产品ID', field: 'ProductID', width: '50px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                //columns.push({
                //    title: '区域大仓', field: 'HouseName', width: '90px', formatter: function (value) {
                //        return "<span title='" + value + "'>" + value + "</span>";
                //    }
                //});
                columns.push({
                    title: '所在仓库', field: 'AreaName', width: '80px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '产品名称', field: 'ProductName', width: '95px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '一级类型', field: 'ParentName', width: '80px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '二级类型', field: 'TypeName', width: '95px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '货位代码', field: 'ContainerCode', width: '80px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '库存', field: 'RealStockNum', width: '40px', align: 'right', styler: function (val, row, index) { return "color:#12bb1f;font-weight:bold;" }, formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '品番', field: 'GoodsCode', width: '100px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '背番', field: 'Specs', width: '70px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '批次', field: 'Batch', width: '70px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '数量', field: 'Numbers', width: '40px', align: 'right', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '入库类型', field: 'OperaType', width: '60px', formatter: function (val, row, index) {
                        if (val == "0") { return "<span title='电脑入库'>电脑入库</span>"; }
                        else if (val == "1") { return "<span title='扫描入库'>扫描入库</span>"; } else { return "<span title='电脑入库'>电脑入库</span>"; }
                    }
                });
                columns.push({
                    title: '入库状态', field: 'InCargoStatus', width: '60px', formatter: function (val, row, index) {
                        if (val == "0") { return "<span title='未入库'>未入库</span>"; }
                        else if (val == "1") { return "<span title='已入库'>已入库</span>"; } else { return "<span title='未入库'>未入库</span>"; }
                    }
                });
                columns.push({ title: '入库时间', field: 'InHouseTime', width: '130px', formatter: DateTimeFormatter });
                columns.push({
                    title: '在库天数', field: 'InHouseDay', width: '65px', align: 'right', styler: function (val, row, index) { return "color:#85C1E9;font-weight:bold;" }, formatter: function (val, row, index) {
                        return getDateStr(row.InHouseTime);
                    }
                });
                columns.push({
                    title: '来源', field: 'Source', width: '100px', formatter: function (value) {
                        return "<span title='" + GetSourceName(value) + "'>" + GetSourceName(value) + "</span>";
                    }
                });
                columns.push({
                    title: '来货单号', field: 'SourceOrderNo', width: '90px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '订单归属月', field: 'BelongMonth', width: '60px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({ title: '操作时间', field: 'OP_DATE', width: '130px', formatter: DateTimeFormatter });
            }
            else if (HID == "63") {
                $("#AGoodsCodeTd").html("产品编码:");
                $('#AGoodsCode').textbox({ prompt: '请输入产品编码' });
                columns.push({
                    title: '', field: '', checkbox: true
                });
                columns.push({ title: '产品ID', field: 'ProductID' });
                columns.push({ title: '一级分类', field: 'ParentName' });
                columns.push({ title: '二级分类', field: 'TypeName' });
                columns.push({ title: '产品编码', field: 'GoodsCode' });
                columns.push({ title: '产品名称', field: 'GoodsName' });
                columns.push({ title: '批次', field: 'Batch' });
                columns.push({ title: '库存', field: 'RealStockNum', align: 'right', styler: function (val, row, index) { return "color:#12bb1f;font-weight:bold;" } });

                columns.push({ title: '基准价', field: 'UnitPrice', align: 'right' });
                //columns.push({ title: '成本价', field: 'CostPrice', align: 'right' });
                columns.push({ title: '供应商', field: 'Supplier' });

                columns.push({ title: '来货单号', field: 'SourceOrderNo' });
                columns.push({ title: '所在仓库', field: 'AreaName' });
                columns.push({ title: '货位代码', field: 'ContainerCode' });
                columns.push({ title: '数量', field: 'Numbers', align: 'right' });
                columns.push({
                    title: '入库类型', field: 'OperaType', formatter: function (val, row, index) {
                        if (val == "0") { return "电脑入库"; }
                        else if (val == "1") { return "扫描入库"; } else { return "电脑入库"; }
                    }
                });
                columns.push({
                    title: '入库状态', field: 'InCargoStatus', formatter: function (val, row, index) {
                        if (val == "0") { return "未入库"; }
                        else if (val == "1") { return "已入库"; } else { return "未入库"; }
                    }
                });
                columns.push({ title: '入库时间', field: 'InHouseTime', width: '130px', formatter: DateTimeFormatter });
                columns.push({
                    title: '在库天数', field: 'InHouseDay', width: '65px', align: 'right', styler: function (val, row, index) { return "color:#85C1E9;font-weight:bold;" }, formatter: function (val, row, index) {
                        return getDateStr(row.InHouseTime);
                    }
                });
                columns.push({
                    title: '锁定状态', field: 'IsLockStock', formatter: function (val, row, index) {
                        if (val == "0") { return "未锁定"; } else if (val == "1") { return "已锁定"; } else { return ""; }
                    }
                });
            }
            else if (HID == "64") {
                columns.push({
                    title: '', field: '', checkbox: true, width: '30px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '产品ID', field: 'ProductID', width: '50px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '一级类型', field: 'ParentName', width: '80px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '品牌', field: 'TypeName', width: '60px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '货品代码', field: 'GoodsCode', width: '90px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '规格', field: 'Specs', width: '85px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '花纹', field: 'Figure', width: '95px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '载速', field: 'LoadIndex', width: '40px', formatter: function (value, row) {
                        return "<span title='" + value + row.SpeedLevel + "'>" + value + row.SpeedLevel + "</span>";
                    }
                });
                //columns.push({
                //    title: '速度', field: 'SpeedLevel', width: '40px', formatter: function (value) {
                //        return "<span title='" + value + "'>" + value + "</span>";
                //    }
                //});

                columns.push({
                    title: '批次', field: 'Batch', width: '40px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '库存', field: 'RealStockNum', width: '40px', align: 'right', styler: function (val, row, index) { return "color:#12bb1f;font-weight:bold;" }, formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '产地', field: 'Born', width: '50px', formatter: function (val, row, index) {
                        if (val == "0") { return "<span title='国产'>国产</span>"; }
                        else if (val == "1") { return "<span title='进口'>进口</span>"; } else { return ""; }
                    }
                });
                columns.push({
                    title: '进货价', field: 'UnitPrice', width: '50px', align: 'right', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '门店价', field: 'TradePrice', width: '50px', align: 'right', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '销售价', field: 'SalePrice', width: '50px', align: 'right', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });

                columns.push({
                    title: '供应商', field: 'Supplier', width: '90px', align: 'right', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '来货单号', field: 'SourceOrderNo', width: '100px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                //columns.push({
                //    title: '区域大仓', field: 'HouseName', width: '80px', formatter: function (value) {
                //        return "<span title='" + value + "'>" + value + "</span>";
                //    }
                //});
                columns.push({
                    title: '所在仓库', field: 'AreaName', width: '80px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '货位代码', field: 'ContainerCode', width: '90px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '数量', field: 'Numbers', width: '40px', align: 'right', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({ title: '入库时间', field: 'InHouseTime', width: '130px', formatter: DateTimeFormatter });
                columns.push({
                    title: '在库天数', field: 'InHouseDay', width: '65px', align: 'right', styler: function (val, row, index) { return "color:#85C1E9;font-weight:bold;" }, formatter: function (val, row, index) {
                        return getDateStr(row.InHouseTime);
                    }
                });

            }
            else {
                columns.push({
                    title: '', field: '', checkbox: true, width: '30px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '产品ID', field: 'ProductID', width: '50px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                //columns.push({
                //    title: '区域大仓', field: 'HouseName', width: '80px', formatter: function (value) {
                //        return "<span title='" + value + "'>" + value + "</span>";
                //    }
                //});
                columns.push({
                    title: '所在仓库', field: 'AreaName', width: '80px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '产品名称', field: 'ProductName', width: '150px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '产品大类', field: 'ParentName', width: '80px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '品牌', field: 'TypeName', width: '60px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '产品编码', field: 'ProductCode', width: '100px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '货位代码', field: 'ContainerCode', width: '80px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '库存', field: 'RealStockNum', width: '40px', align: 'right', styler: function (val, row, index) { return "color:#12bb1f;font-weight:bold;" }, formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '货品代码', field: 'GoodsCode', width: '90px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '型号', field: 'Model', width: '75px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '规格', field: 'Specs', width: '75px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '花纹', field: 'Figure', width: '95px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '载重', field: 'LoadIndex', width: '40px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '速度', field: 'SpeedLevel', width: '40px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '批次', field: 'Batch', width: '40px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '数量', field: 'Numbers', width: '40px', align: 'right', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '单价', field: 'UnitPrice', width: '50px', align: 'right', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '次日达价', field: 'NextDayPrice', width: '50px', align: 'right', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '入库类型', field: 'OperaType', width: '60px', formatter: function (val, row, index) {
                        if (val == "0") { return "<span title='电脑入库'>电脑入库</span>"; }
                        else if (val == "1") { return "<span title='扫描入库'>扫描入库</span>"; } else { return "<span title='电脑入库'>电脑入库</span>"; }
                    }
                });
                columns.push({
                    title: '入库状态', field: 'InCargoStatus', width: '60px', formatter: function (val, row, index) {
                        if (val == "0") { return "<span title='未入库'>未入库</span>"; }
                        else if (val == "1") { return "<span title='已入库'>已入库</span>"; } else { return "<span title='未入库'>未入库</span>"; }
                    }
                });
                columns.push({ title: '入库时间', field: 'InHouseTime', width: '130px', formatter: DateTimeFormatter });
                columns.push({
                    title: '在库天数', field: 'InHouseDay', width: '65px', align: 'right', styler: function (val, row, index) { return "color:#85C1E9;font-weight:bold;" }, formatter: function (val, row, index) {
                        return getDateStr(row.InHouseTime);
                    }
                });
                columns.push({
                    title: '产地', field: 'Born', width: '50px', formatter: function (val, row, index) {
                        if (val == "0") { return "<span title='国产'>国产</span>"; }
                        else if (val == "1") { return "<span title='进口'>进口</span>"; } else { return ""; }
                    }
                });
                columns.push({
                    title: 'OERE', field: 'Assort', width: '50px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '销售价', field: 'SalePrice', width: '50px', align: 'right', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '门店价', field: 'TradePrice', width: '50px', align: 'right', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '供应商', field: 'Supplier', width: '90px', align: 'right', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '来源', field: 'Source', width: '100px', formatter: function (value) {
                        return "<span title='" + GetSourceName(value) + "'>" + GetSourceName(value) + "</span>";
                    }
                });
                columns.push({
                    title: '归属部门', field: 'BelongDepart', width: '100px', formatter: function (value) {
                        return "<span title='" + GetUpClientDepName(value) + "'>" + GetUpClientDepName(value) + "</span>";
                    }
                });
                columns.push({
                    title: '规格类型', field: 'SpecsType', width: '65px', formatter: function (val, row, index) {
                        if (val == "0") { return "<span title='分配规格'>分配规格</span>"; }
                        else if (val == "1") { return "<span title='普通规格'>普通规格</span>"; }
                        else if (val == "2") { return "<span title='特价分配规格'>特价分配规格</span>"; }
                        else if (val == "3") { return "<span title='手工单'>手工单</span>"; }
                        else { return ""; }
                    }
                });
                columns.push({
                    title: '来货单号', field: 'SourceOrderNo', width: '80px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '订单归属月', field: 'BelongMonth', width: '60px', formatter: function (value) {
                        return "<span title='" + value + "'>" + value + "</span>";
                    }
                });
                columns.push({
                    title: '锁定库存', field: 'IsLockStock', width: '50px', formatter: function (val, row, index) {
                        if (val == "0") { return "<span title='未锁定'>未锁定</span>"; }
                        else if (val == "1") { return "<span title='已锁定'>已锁定</span>"; } else { return ""; }
                    }
                });
                columns.push({ title: '操作时间', field: 'OP_DATE', width: '130px', formatter: DateTimeFormatter });

            }

            $('#dg').datagrid({
                width: '100%',
                title: '', //标题内容
                loadMsg: '数据加载中请稍候...',
                autoRowHeight: false, //行高是否自动
                collapsible: true, //是否可折叠
                pagination: true, //分页是否显示
                pageSize: Math.floor((Number($(window).height()) - $("div[name='SelectDiv1']").outerHeight(true) - 58) / 28), //每页多少条
                pageList: [Math.floor((Number($(window).height()) - $("div[name='SelectDiv1']").outerHeight(true) - 58) / 28), Math.floor((Number($(window).height()) - $("div[name='SelectDiv1']").outerHeight(true) - 58) / 28) * 2],
                fitColumns: false, //设置为 true，则会自动扩大或缩小列的尺寸以适应网格的宽度并且防止水平滚动
                singleSelect: false, //设置为 true，则只允许选中一行。
                checkOnSelect: true, //如果设置为 true，当用户点击某一行时，则会选中/取消选中复选框。如果设置为 false 时，只有当用户点击了复选框时，才会选中/取消选中复选框
                idField: 'ProductID',
                url: null,
                toolbar: '#toolbar',
                columns: [columns],
                onLoadSuccess: function (data) { },
                onClickRow: function (index, row) {
                    $('#dg').datagrid('clearSelections');
                    $('#dg').datagrid('selectRow', index);
                },
                onDblClickRow: function (index, row) { editItemByID(index); },
                rowStyler: function (index, row) {
                    if (row.InCargoStatus == "0") { return "background-color:#D1EEEE"; }
                    if (row.IsLockStock == "1") { return "background-color:#f7e9ee"; }
                    //else if (row.InCargoStatus == "1" && row.ContainerCode == "") { return "background-color:#EBEBEB"; }
                }
            });
            //所在仓库
            $('#AHouseID').combobox({
                url: '../House/houseApi.aspx?method=CargoPermisionHouse',
                valueField: 'HouseID', textField: 'Name',
                onSelect: function (rec) {
                    $('#AHID').combobox('clear');
                    var url = '../House/houseApi.aspx?method=QueryALLArea&pid=0&hid=' + rec.HouseID;
                    $('#AHID').combobox('reload', url);
                    var url = '../Client/clientApi.aspx?method=QueryAllUpClientDep&type=1&houseID=' + rec.HouseID;
                    $('#ABelongDepart').combobox('reload', url);
                    $('#ABelongDepart').combobox('select', '-1');
                }
            });
            $('#AHouseID').combobox('setValue', '<%=UserInfor.HouseID%>');
            $('#AHID').combobox('clear');
            var url = '../House/houseApi.aspx?method=QueryALLArea&pid=0&hid=<%=UserInfor.HouseID%>';
            $('#AHID').combobox('reload', url);
            //一级产品
            $('#APID').combobox({
                url: 'productApi.aspx?method=QueryALLOneProductType', valueField: 'TypeID', textField: 'TypeName',
                onSelect: function (rec) {
                    $('#ASID').combobox('clear');
                    $('#ASID').combobox({
                        url: '../Product/productApi.aspx?method=QueryALLOneProductType&PID=' + rec.TypeID, valueField: 'TypeID', textField: 'TypeName', AddField: 'PinyinName',
                        filter: function (q, row) {
                            var opts = $(this).combobox('options');
                            return row[opts.textField].indexOf(q) >= 0 || row[opts.AddField].indexOf(q) >= 0;
                        },
                    });
                }
            });
            //一级产品
            $('#ParentID').combobox({
                url: 'productApi.aspx?method=QueryALLOneProductType', valueField: 'TypeID', textField: 'TypeName', editable: false,
                onSelect: function (rec) {
                    $('#TypeID').combobox('clear');
                    $('#TypeID').combobox({
                        url: '../Product/productApi.aspx?method=QueryALLOneProductType&PID=' + rec.TypeID, valueField: 'TypeID', textField: 'TypeName', AddField: 'PinyinName',
                        filter: function (q, row) {
                            var opts = $(this).combobox('options');
                            return row[opts.textField].indexOf(q) >= 0 || row[opts.AddField].indexOf(q) >= 0;
                        },
                    });
                }
            });
            $('#ASID').combobox('textbox').bind('focus', function () { $('#ASID').combobox('showPanel'); });
            $('#APID').combobox('textbox').bind('focus', function () { $('#APID').combobox('showPanel'); });
            //$('#AInCargoStatus').combobox('textbox').bind('focus', function () { $('#AInCargoStatus').combobox('showPanel'); });
            var SourceUrl = '../Product/productApi.aspx?method=QueryAllProductSource';
            $('#ProductSource').combobox('reload', SourceUrl);
            var IHH = "<%=UserInfor.IsHeadHouse%>";
            if (IHH == "1") {
                $('#AHID').combobox('setText', '<%=UserInfor.HeadHouseName%>');
                $('#AHID').combobox('setValue', '<%=UserInfor.HeadHouseID%>');
                $("#AHID").combobox("readonly", true);
                $("#AHouseID").combobox("readonly", true);
                $('#btnAdd').hide();
                $('#btnUpdate').hide();
                $('#btnDel').hide();
                $('#btnCopy').hide();
                $('#btnIn').hide();
                $('#btnLotinIn').hide();
                $('#btnPrint').hide();
                $('#btnCancleIn').hide();
                //$('#btnTag').hide();
            } else {
                $('#AHouseID').combobox('textbox').bind('focus', function () { $('#AHouseID').combobox('showPanel'); });
                $('#AHID').combobox('textbox').bind('focus', function () { $('#AHID').combobox('showPanel'); });

            }
            $('#ASupplier').combobox({
                valueField: 'Boss', textField: 'Boss', AddField: 'PinyinName', delay: '10',
                url: '../Client/clientApi.aspx?method=AutoCompleteClient',
                filter: function (q, row) {
                    var opts = $(this).combobox('options');
                    return row[opts.textField].indexOf(q) >= 0 || row[opts.AddField].indexOf(q) >= 0;
                },
                required: false
            });
            $('#ASupplier').combobox('textbox').bind('focus', function () { $('#ASupplier').combobox('showPanel'); });
            $('#ASpecs').textbox('textbox').keydown(function (e) {
                if (e.keyCode == 13) {
                    dosearch();
                }
            });
            $('#AFigure').textbox('textbox').keydown(function (e) {
                if (e.keyCode == 13) {
                    dosearch();
                }
            });
            $('#ProductID').textbox('textbox').keydown(function (e) {
                if (e.keyCode == 13) {
                    dosearch();
                }
            });
        });
        function getDateStr(obj) {
            var s, y, m, d, str, str1, a, b, a1, b1;
            s = new Date();
            y = s.getFullYear();
            m = s.getMonth() + 1;
            d = s.getDate();
            if (m >= 1 && m <= 9) m = '0' + m;
            if (d >= 1 && d <= 9) d = '0' + d;
            str = y + '-' + m + '-' + d;
            a = str.split('-');

            obj = new Date(obj);
            y = obj.getFullYear();
            m = obj.getMonth() + 1;
            d = obj.getDate();
            if (m >= 1 && m <= 9) m = '0' + m;
            if (d >= 1 && d <= 9) d = '0' + d;
            str1 = y + '-' + m + '-' + d;
            b = str1.split('-');
            a1 = new Date(a[1] + '-' + a[2] + '-' + a[0]);
            b1 = new Date(b[1] + '-' + b[2] + '-' + b[0]);
            var Days = parseInt(a1 - b1) / 1000 / 60 / 60 / 24;
            //var Days = parseInt(Math.abs(a1-b1)/1000/60/60/24);
            return Days;
        }
        //查询
        function dosearch() {
            var type = 0;
            var columns = [];
            if ($('#AHouseID').combobox('getValue') != $('#HiddenHouseID').val()) {
                $('#HiddenHouseID').val($('#AHouseID').combobox('getValue'));
                if ($('#AHouseID').combobox('getValue') == "47") {
                    $("#AModelTd").html("商贸编码:");
                    $('#AModel').textbox({ prompt: '请输入商贸编码' });
                    $("#AFigureTd").html("长和编码:");
                    $('#AFigure').textbox({ prompt: '请输入长和编码' });
                    $("#AGoodsCodeTd").html("富添盛编码:");
                    $('#AGoodsCode').textbox({ prompt: '请输入富添盛编码' });
                    //$("#ASpecsTd").html("祺航编码:");
                    //$('#ASpecs').textbox({ prompt: '请输入祺航编码' });
                    $("td.ATagCodeTd").hide();
                    $("td.AFigureTd").hide();
                    $("td.AModel").hide();
                    $("td.ASpeedLevelTd").hide();
                    $("td.ALoadIndexTd").hide();
                    $("td.ABelongDepartTd").hide();
                    columns.push({
                        title: '', field: '', checkbox: true, width: '30px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '产品ID', field: 'ProductID', width: '50px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    //columns.push({
                    //    title: '区域大仓', field: 'HouseName', width: '80px', formatter: function (value) {
                    //        return "<span title='" + value + "'>" + value + "</span>";
                    //    }
                    //});
                    columns.push({
                        title: '所在仓库', field: 'AreaName', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '一级类型', field: 'ParentName', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '二级类型', field: 'TypeName', width: '60px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '富添盛编码', field: 'GoodsCode', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '商贸编码', field: 'Model', width: '110px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '长和编码', field: 'Figure', width: '100px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '产品名称', field: 'ProductName', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '规格', field: 'Specs', width: '100px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '货位代码', field: 'ContainerCode', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '库存', field: 'RealStockNum', width: '40px', align: 'right', styler: function (val, row, index) { return "color:#12bb1f;font-weight:bold;" }, formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '单位', field: 'Package', width: '40px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '成本价', field: 'TradePrice', width: '60px', align: 'right', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '数量', field: 'Numbers', width: '60px', align: 'right', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '入库类型', field: 'OperaType', width: '60px', formatter: function (val, row, index) {
                            if (val == "0") { return "<span title='电脑入库'>电脑入库</span>"; }
                            else if (val == "1") { return "<span title='扫描入库'>扫描入库</span>"; } else { return "<span title='电脑入库'>电脑入库</span>"; }
                        }
                    });
                    columns.push({
                        title: '入库状态', field: 'InCargoStatus', width: '60px', formatter: function (val, row, index) {
                            if (val == "0") { return "<span title='未入库'>未入库</span>"; }
                            else if (val == "1") { return "<span title='已入库'>已入库</span>"; } else { return "<span title='未入库'>未入库</span>"; }
                        }
                    });
                    columns.push({ title: '入库时间', field: 'InHouseTime', width: '130px', formatter: DateTimeFormatter });
                    columns.push({
                        title: '在库天数', field: 'InHouseDay', width: '65px', align: 'right', styler: function (val, row, index) { return "color:#85C1E9;font-weight:bold;" }, formatter: function (val, row, index) {
                            return getDateStr(row.InHouseTime);
                        }
                    });
                    columns.push({ title: '操作时间', field: 'OP_DATE', width: '130px', formatter: DateTimeFormatter });
                } else if (HID == "62") {

                    columns.push({
                        title: '', field: '', checkbox: true, width: '30px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '产品ID', field: 'ProductID', width: '50px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    //columns.push({
                    //    title: '区域大仓', field: 'HouseName', width: '80px', formatter: function (value) {
                    //        return "<span title='" + value + "'>" + value + "</span>";
                    //    }
                    //});
                    columns.push({
                        title: '所在仓库', field: 'AreaName', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '产品名称', field: 'ProductName', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '一级类型', field: 'ParentName', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '二级类型', field: 'TypeName', width: '60px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '货位代码', field: 'ContainerCode', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '库存', field: 'RealStockNum', width: '40px', align: 'right', styler: function (val, row, index) { return "color:#12bb1f;font-weight:bold;" }, formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '品番', field: 'GoodsCode', width: '100px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '背番', field: 'Specs', width: '70px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '批次', field: 'Batch', width: '70px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '数量', field: 'Numbers', width: '40px', align: 'right', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '入库类型', field: 'OperaType', width: '60px', formatter: function (val, row, index) {
                            if (val == "0") { return "<span title='电脑入库'>电脑入库</span>"; }
                            else if (val == "1") { return "<span title='扫描入库'>扫描入库</span>"; } else { return "<span title='电脑入库'>电脑入库</span>"; }
                        }
                    });
                    columns.push({
                        title: '入库状态', field: 'InCargoStatus', width: '60px', formatter: function (val, row, index) {
                            if (val == "0") { return "<span title='未入库'>未入库</span>"; }
                            else if (val == "1") { return "<span title='已入库'>已入库</span>"; } else { return "<span title='未入库'>未入库</span>"; }
                        }
                    });
                    columns.push({ title: '入库时间', field: 'InHouseTime', width: '130px', formatter: DateTimeFormatter });
                    columns.push({
                        title: '在库天数', field: 'InHouseDay', width: '65px', align: 'right', styler: function (val, row, index) { return "color:#85C1E9;font-weight:bold;" }, formatter: function (val, row, index) {
                            return getDateStr(row.InHouseTime);
                        }
                    });
                    columns.push({
                        title: '来源', field: 'Source', width: '100px', formatter: function (value) {
                            return "<span title='" + GetSourceName(value) + "'>" + GetSourceName(value) + "</span>";
                        }
                    });
                    columns.push({
                        title: '来货单号', field: 'SourceOrderNo', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '订单归属月', field: 'BelongMonth', width: '60px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({ title: '操作时间', field: 'OP_DATE', width: '130px', formatter: DateTimeFormatter });
                } else if (HID == "64") {
                    columns.push({
                        title: '', field: '', checkbox: true, width: '30px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '产品ID', field: 'ProductID', width: '50px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });

                    columns.push({
                        title: '一级类型', field: 'ParentName', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '品牌', field: 'TypeName', width: '60px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });

                    columns.push({
                        title: '规格', field: 'Specs', width: '75px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '花纹', field: 'Figure', width: '95px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '载速', field: 'LoadIndex', width: '40px', formatter: function (value, row) {
                            return "<span title='" + value + row.SpeedLevel + "'>" + value + row.SpeedLevel + "</span>";
                        }
                    });
                    //columns.push({
                    //    title: '速度', field: 'SpeedLevel', width: '40px', formatter: function (value) {
                    //        return "<span title='" + value + "'>" + value + "</span>";
                    //    }
                    //});
                    columns.push({
                        title: '货品代码', field: 'GoodsCode', width: '90px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '批次', field: 'Batch', width: '40px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });

                    columns.push({
                        title: '库存', field: 'RealStockNum', width: '40px', align: 'right', styler: function (val, row, index) { return "color:#12bb1f;font-weight:bold;" }, formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });

                    columns.push({
                        title: '产地', field: 'Born', width: '50px', formatter: function (val, row, index) {
                            if (val == "0") { return "<span title='国产'>国产</span>"; }
                            else if (val == "1") { return "<span title='进口'>进口</span>"; } else { return ""; }
                        }
                    });
                    columns.push({
                        title: '销售价', field: 'SalePrice', width: '50px', align: 'right', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '门店价', field: 'TradePrice', width: '50px', align: 'right', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '供应商', field: 'Supplier', width: '80px', align: 'right', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '来货单号', field: 'SourceOrderNo', width: '100px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    //columns.push({
                    //    title: '区域大仓', field: 'HouseName', width: '80px', formatter: function (value) {
                    //        return "<span title='" + value + "'>" + value + "</span>";
                    //    }
                    //});
                    columns.push({
                        title: '所在仓库', field: 'AreaName', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '货位代码', field: 'ContainerCode', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '数量', field: 'Numbers', width: '40px', align: 'right', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({ title: '入库时间', field: 'InHouseTime', width: '130px', formatter: DateTimeFormatter });
                    columns.push({
                        title: '在库天数', field: 'InHouseDay', width: '65px', align: 'right', styler: function (val, row, index) { return "color:#85C1E9;font-weight:bold;" }, formatter: function (val, row, index) {
                            return getDateStr(row.InHouseTime);
                        }
                    });

                }
                else if (HID == "63") {
                    $("#AGoodsCodeTd").html("产品编码:");
                    $('#AGoodsCode').textbox({ prompt: '请输入产品编码' });
                    columns.push({
                        title: '', field: '', checkbox: true
                    });
                    columns.push({ title: '产品ID', field: 'ProductID' });
                    columns.push({ title: '一级分类', field: 'ParentName' });
                    columns.push({ title: '二级分类', field: 'TypeName' });
                    columns.push({ title: '产品编码', field: 'GoodsCode' });
                    columns.push({ title: '产品名称', field: 'GoodsName' });
                    columns.push({ title: '批次', field: 'Batch' });
                    columns.push({ title: '库存', field: 'RealStockNum', align: 'right', styler: function (val, row, index) { return "color:#12bb1f;font-weight:bold;" } });

                    columns.push({ title: '基准价', field: 'UnitPrice', align: 'right' });
                    //columns.push({ title: '成本价', field: 'CostPrice', align: 'right' });
                    columns.push({ title: '供应商', field: 'Supplier' });

                    columns.push({ title: '来货单号', field: 'SourceOrderNo' });
                    columns.push({ title: '所在仓库', field: 'AreaName' });
                    columns.push({ title: '货位代码', field: 'ContainerCode' });
                    columns.push({ title: '数量', field: 'Numbers', align: 'right' });
                    columns.push({
                        title: '入库类型', field: 'OperaType', formatter: function (val, row, index) {
                            if (val == "0") { return "电脑入库"; }
                            else if (val == "1") { return "扫描入库"; } else { return "电脑入库"; }
                        }
                    });
                    columns.push({
                        title: '入库状态', field: 'InCargoStatus', formatter: function (val, row, index) {
                            if (val == "0") { return "未入库"; }
                            else if (val == "1") { return "已入库"; } else { return "未入库"; }
                        }
                    });
                    columns.push({ title: '入库时间', field: 'InHouseTime', width: '130px', formatter: DateTimeFormatter });
                    columns.push({
                        title: '在库天数', field: 'InHouseDay', width: '65px', align: 'right', styler: function (val, row, index) { return "color:#85C1E9;font-weight:bold;" }, formatter: function (val, row, index) {
                            return getDateStr(row.InHouseTime);
                        }
                    });
                    columns.push({
                        title: '锁定状态', field: 'IsLockStock', formatter: function (val, row, index) {
                            if (val == "0") { return "未锁定"; } else if (val == "1") { return "已锁定"; } else { return ""; }
                        }
                    });
                }
                else {
                    $("#AModelTd").html("型号:");
                    $('#AModel').textbox({ prompt: '请输入型号' });
                    $("#AFigureTd").html("花纹:");
                    $('#AFigure').textbox({ prompt: '请输入花纹' });
                    $("#AGoodsCodeTd").html("货品代码:");
                    $('#AGoodsCode').textbox({ prompt: '请输入货品代码' });
                    $("#ASpecsTd").html("规格:");
                    $('#ASpecs').textbox({ prompt: '请输入规格' });
                    $("td.ATagCodeTd").show();
                    $("td.AModel").show();
                    $("td.AFigureTd").show();
                    $("td.ASpeedLevelTd").show();
                    $("td.ALoadIndexTd").show();
                    $("td.ABelongDepartTd").show();
                    //if ($('#AHouseID').combobox('getValue') == "9") {
                    //    $("td.ABelongDepartTd").show();
                    //} else {
                    //    $("td.ABelongDepartTd").hide();
                    //}
                    columns.push({
                        title: '', field: '', checkbox: true, width: '30px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '产品ID', field: 'ProductID', width: '50px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    //columns.push({
                    //    title: '区域大仓', field: 'HouseName', width: '80px', formatter: function (value) {
                    //        return "<span title='" + value + "'>" + value + "</span>";
                    //    }
                    //});
                    columns.push({
                        title: '所在仓库', field: 'AreaName', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '产品名称', field: 'ProductName', width: '150px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '产品大类', field: 'ParentName', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '品牌', field: 'TypeName', width: '60px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '产品编码', field: 'ProductCode', width: '100px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '货位代码', field: 'ContainerCode', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '库存', field: 'RealStockNum', width: '40px', align: 'right', styler: function (val, row, index) { return "color:#12bb1f;font-weight:bold;" }, formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '货品代码', field: 'GoodsCode', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '型号', field: 'Model', width: '60px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '规格', field: 'Specs', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '花纹', field: 'Figure', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '载重', field: 'LoadIndex', width: '40px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '速度', field: 'SpeedLevel', width: '40px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '批次', field: 'Batch', width: '40px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '数量', field: 'Numbers', width: '40px', align: 'right', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '单价', field: 'UnitPrice', width: '50px', align: 'right', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '次日达价', field: 'NextDayPrice', width: '50px', align: 'right', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '入库类型', field: 'OperaType', width: '60px', formatter: function (val, row, index) {
                            if (val == "0") { return "<span title='电脑入库'>电脑入库</span>"; }
                            else if (val == "1") { return "<span title='扫描入库'>扫描入库</span>"; } else { return "<span title='电脑入库'>电脑入库</span>"; }
                        }
                    });
                    columns.push({
                        title: '入库状态', field: 'InCargoStatus', width: '60px', formatter: function (val, row, index) {
                            if (val == "0") { return "<span title='未入库'>未入库</span>"; }
                            else if (val == "1") { return "<span title='已入库'>已入库</span>"; } else { return "<span title='未入库'>未入库</span>"; }
                        }
                    });
                    columns.push({ title: '入库时间', field: 'InHouseTime', width: '130px', formatter: DateTimeFormatter });
                    columns.push({
                        title: '在库天数', field: 'InHouseDay', width: '65px', align: 'right', styler: function (val, row, index) { return "color:#85C1E9;font-weight:bold;" }, formatter: function (val, row, index) {
                            return getDateStr(row.InHouseTime);
                        }
                    });
                    columns.push({
                        title: '产地', field: 'Born', width: '50px', formatter: function (val, row, index) {
                            if (val == "0") { return "<span title='国产'>国产</span>"; }
                            else if (val == "1") { return "<span title='进口'>进口</span>"; } else { return ""; }
                        }
                    });
                    columns.push({
                        title: 'OERE', field: 'Assort', width: '50px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '销售价', field: 'SalePrice', width: '50px', align: 'right', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '门店价', field: 'TradePrice', width: '50px', align: 'right', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '供应商', field: 'Supplier', width: '80px', align: 'right', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '来源', field: 'Source', width: '100px', formatter: function (value) {
                            return "<span title='" + GetSourceName(value) + "'>" + GetSourceName(value) + "</span>";
                        }
                    });
                    columns.push({
                        title: '归属部门', field: 'BelongDepart', width: '100px', formatter: function (value) {
                            return "<span title='" + GetUpClientDepName(value) + "'>" + GetUpClientDepName(value) + "</span>";
                        }
                    });
                    columns.push({
                        title: '规格类型', field: 'SpecsType', width: '65px', formatter: function (val, row, index) {
                            if (val == "0") { return "<span title='分配规格'>分配规格</span>"; }
                            else if (val == "1") { return "<span title='普通规格'>普通规格</span>"; }
                            else if (val == "2") { return "<span title='特价分配规格'>特价分配规格</span>"; }
                            else if (val == "3") { return "<span title='手工单'>手工单</span>"; }
                            else { return ""; }
                        }
                    });
                    columns.push({
                        title: '来货单号', field: 'SourceOrderNo', width: '80px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '订单归属月', field: 'BelongMonth', width: '60px', formatter: function (value) {
                            return "<span title='" + value + "'>" + value + "</span>";
                        }
                    });
                    columns.push({
                        title: '锁定库存', field: 'IsLockStock', width: '50px', formatter: function (val, row, index) {
                            if (val == "0") { return "<span title='未锁定'>未锁定</span>"; }
                            else if (val == "1") { return "<span title='已锁定'>已锁定</span>"; } else { return ""; }
                        }
                    });
                    columns.push({ title: '操作时间', field: 'OP_DATE', width: '130px', formatter: DateTimeFormatter });
                }
                type = 1;
            }
            var BatchYear;
            var ABW = $('#ABatchWeek').combobox('getValue');
            var datenow = new Date();
            var mont = datenow.getMonth() + 1;
            var bw;
            if (ABW == "0") {
                //半年前
                if (mont <= 6) {
                    bw = datenow.getFullYear().toString().substr(2, 2) - 1;
                } else {
                    bw = datenow.getFullYear().toString().substr(2, 2);
                }
            }
            else if (ABW == "1") {
                //一年前
                if (mont <= 12) {
                    bw = datenow.getFullYear().toString().substr(2, 2) - 1;
                } else {
                    bw = datenow.getFullYear().toString().substr(2, 2);
                }
            }
            else if (ABW == "2") {
                //10个月以前
                if (mont <= 10) {
                    bw = datenow.getFullYear().toString().substr(2, 2) - 1;
                } else {
                    bw = datenow.getFullYear().toString().substr(2, 2);
                }
            }
            else if (ABW == "3") {
                //30周以前
                if (mont <= 10) {
                    bw = datenow.getFullYear().toString().substr(2, 2) - 1;
                } else {
                    bw = datenow.getFullYear().toString().substr(2, 2);
                }
            }
            else if (ABW == "4") {
                //9个月以前
                if (mont <= 9) {
                    bw = datenow.getFullYear().toString().substr(2, 2) - 1;
                } else {
                    bw = datenow.getFullYear().toString().substr(2, 2);
                }
            }
            else if (ABW == "22") { BatchYear = 22; ABW = "-1"; bw = ""; }
            else if (ABW == "23") { BatchYear = 23; ABW = "-1"; bw = ""; }
            else {
                bw = "";
            }
            $('#dg').datagrid('clearSelections');
            var gridOpts = $('#dg').datagrid('options');
            gridOpts.url = 'productApi.aspx?method=QueryProduct';
            $('#dg').datagrid('load', {
                Specs: $('#ASpecs').val(),
                Model: $('#AModel').val(),
                GoodsCode: $('#AGoodsCode').val(),//AMeridian
                PID: $("#APID").combobox('getValue'),//一级产品
                SID: $("#ASID").combobox('getValue'),//二级产品
                ProductName: $('#AProductName').val(),
                Batch: $('#ABatch').val(),
                BatchWeek: bw,
                PriceType: ABW,
                BatchYear: BatchYear,
                Figure: $('#AFigure').val(),
                ProductCode: $('#AProductCode').val(),
                InCargoStatus: "-1",
                //InCargoStatus: $('#AInCargoStatus').combobox('getValue'),
                LoadIndex: $('#ALoadIndex').val(),
                ProductID: $('#ProductID').val(),
                HouseID: $("#AHouseID").combobox('getValue'),//仓库ID
                ProductSource: $("#ProductSource").combobox('getValue'),//仓库ID
                AHID: $("#AHID").combobox('getValue'),//一级仓库
                //AAID: $("#AAID").combobox('getValue'),//一级区域
                //SpeedLevel: $("#ASpeedLevel").combobox('getValue'),
                SourceOrderNo: $("#BSourceOrderNo").val(),
                Supplier: $('#ASupplier').combobox('getValue'),
                StartDate: $('#StartDate').datebox('getValue'),
                EndDate: $('#EndDate').datebox('getValue'),
                BelongDepart: $("#ABelongDepart").combobox('getValue'),//归属部门
                IsLockStock: $('#AlockStock').combobox('getValue'),
                TagCode: $("#ATagCode").val(),//轮胎唯一编码
                TyreCode: $("#ATyreCode").val(),//轮胎唯一编码
                SpecsType: $("#SpecsType").combobox('getValue'),
            });
            if (type == 1) {
                $('#dg').datagrid({
                    columns: [columns]
                })
            }
        }
    </script>
</asp:Content>

<asp:Content ID="Content2" ContentPlaceHolderID="ContentPlaceHolder1" runat="server">
    <div id='Loading' style="position: absolute; z-index: 1000; top: 0px; left: 0px; width: 98%; height: 100%; background: white; text-align: center; padding: 5px 10px; display: table;">
        <div style="display: table-cell; vertical-align: middle">
            <h1><font size="9">页面加载中……</font></h1>
        </div>
    </div>
    <div id="saPanel" name="SelectDiv1" class="easyui-panel" title="" data-options="iconCls:'icon-search'" style="width: 100%">
        <table>
            <tr>
                <td id="ASpecsTd" style="text-align: right;">规格:
                </td>
                <td>
                    <input id="ASpecs" class="easyui-textbox" data-options="prompt:'请输入规格'" style="width: 80px" />
                </td>
                <td class="ProductIDTd" style="text-align: right;">产品ID:
                </td>
                <td class="ProductIDTd">
                    <input id="ProductID" class="easyui-textbox" data-options="prompt:'请输入产品ID'" style="width: 80px" />
                </td>

                <td style="text-align: right;">产品名称:
                </td>
                <td>
                    <%-- <input id="ATreadWidth" class="easyui-numberbox" data-options="min:0,precision:2" style="width: 100px">--%>
                    <input id="AProductName" class="easyui-textbox" data-options="prompt:'请输入产品名称'" style="width: 100px" />
                </td>
                <td class="AModel" id="AModelTd" style="text-align: right;">内侧码:
                </td>
                <td class="AModel">
                    <input id="ATyreCode" class="easyui-textbox" data-options="prompt:'请输入内侧码'" style="width: 100px" />
                </td>
                <td style="text-align: right;">产品编码:
                </td>
                <td>
                    <input id="AProductCode" class="easyui-textbox" data-options="prompt:'请输入产品编码'" style="width: 100px" />
                </td>
                <%-- <td style="text-align: right;">入库状态:
                </td>
                <td>
                    <select class="easyui-combobox" id="AInCargoStatus" style="width: 100px;" panelheight="auto">
                        <option value="-1">全部</option>
                        <option value="0">未入库</option>
                        <option value="1">已入库</option>
                    </select>
                </td>--%>
                <td style="text-align: right;">一级产品:
                </td>
                <td>
                    <input id="APID" class="easyui-combobox" style="width: 100px;" panelheight="auto" />
                </td>
                <td style="text-align: right;">区域大仓:
                </td>
                <td>
                    <input id="AHouseID" class="easyui-combobox" style="width: 100px;" />
                </td>
                <td class="ASpecsType" style="text-align: right;">规格类型:
                </td>
                <td class="ASpecsType">
                    <select class="easyui-combobox" id="SpecsType" name="SpecsType" style="width: 80px;" panelheight="auto" editable="false">
                        <option value="-1">全部</option>
                        <option value="0">分配规格</option>
                        <option value="1">普通规格</option>
                        <option value="2">特价分配规格</option>
                        <option value="3">手工单</option>
                        <option value="4">云仓即日达</option>
                        <option value="5">云仓次日达</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td class="AFigureTd" id="AFigureTd" style="text-align: right;">花纹:
                </td>
                <td class="AFigureTd">
                    <input id="AFigure" class="easyui-textbox" data-options="prompt:'请输入花纹'" style="width: 80px" />
                </td>

                <td style="text-align: right;">批次:
                </td>
                <td>
                    <input id="ABatch" class="easyui-textbox" data-options="prompt:'请输入批次'" style="width: 80px" />
                </td>
                <td id="AGoodsCodeTd" style="text-align: right;">货品代码:
                </td>
                <td>
                    <input id="AGoodsCode" class="easyui-textbox" data-options="prompt:'请输入货品代码'" style="width: 100px" />
                </td>
                <td class="ATagCodeTd" style="text-align: right;">轮胎编码:
                </td>
                <td class="ATagCodeTd">
                    <input id="ATagCode" class="easyui-textbox" data-options="prompt:'请输入轮胎编码'" style="width: 100px" />
                </td>
                <td class="ASpeedLevelTd" style="text-align: right;">来货单号:
                </td>
                <td class="ASpeedLevelTd">
                    <input id="BSourceOrderNo" class="easyui-textbox" data-options="prompt:'请输入来货单号'" style="width: 100px" />
                </td>
                <%--  <td class="ASpeedLevelTd" style="text-align: right;">速度级别:
                </td>
                <td class="ASpeedLevelTd">
                    <input class="easyui-combobox" id="ASpeedLevel" data-options="url:'../Data/TyreSpeedLevel.json',method:'get',valueField:'id',textField:'text'"
                        style="width: 100px;">
                </td>--%>
                <td style="text-align: right;">二级产品:
                </td>
                <td>
                    <input id="ASID" class="easyui-combobox" style="width: 100px;" data-options="valueField:'TypeID',textField:'TypeName'" />
                </td>
                <td style="text-align: right;">所属仓库:
                </td>
                <td>
                    <input id="AHID" class="easyui-combobox" style="width: 100px;" data-options="valueField:'AreaID',textField:'Name'" panelheight="auto" />
                </td>
                <%-- <td style="text-align: right;">一级区域:
                </td>
                <td>
                    <input id="AAID" class="easyui-combobox" style="width: 100px;" data-options="valueField:'AreaID',textField:'Name'"
                        panelheight="auto" />
                </td>--%>
            </tr>
            <tr>
                <td style="text-align: right;">入库时间:
                </td>
                <td colspan="3">
                    <input id="StartDate" class="easyui-datebox" style="width: 100px" />~
                    <input id="EndDate" class="easyui-datebox" style="width: 100px" />
                </td>
                <td style="text-align: right;">产品来源:
                </td>
                <td>
                    <input id="ProductSource" name="ProductSource" class="easyui-combobox" style="width: 100px;" data-options="valueField:'Source',textField:'SourceName',editable:false" />
                </td>
                <td class="ABelongDepartTd" style="text-align: right;">归属部门:
                </td>
                <td class="ABelongDepartTd">
                    <input id="ABelongDepart" class="easyui-combobox" style="width: 100px;" data-options="valueField:'ID',textField:'DepName',editable:false" />
                    <%--<select class="easyui-combobox" id="ABelongDepart" style="width: 100px;" panelheight="auto" editable="false">
                        <option value="-1">全部</option>
                        <option value="0">RE渠道销售部</option>
                        <option value="1">OE渠道销售部</option>
                    </select>--%>
                </td>
                <td style="text-align: right;">供应商:</td>
                <td>
                    <input id="ASupplier" style="width: 100px;" class="easyui-combobox AcceptPeople" data-options="valueField:'Boss',textField:'Boss',editable:true" /></td>
                <td style="text-align: right;">锁定状态:
                </td>
                <td>
                    <select class="easyui-combobox" id="AlockStock" style="width: 100px;" panelheight="auto">
                        <option value="-1">全部</option>
                        <option value="0">未锁定</option>
                        <option value="1">已锁定</option>
                    </select>
                </td>
                <td class="ABatchWeek" style="text-align: right;">周期年周:
                </td>
                <td class="ABatchWeek">
                    <select class="easyui-combobox" id="ABatchWeek" style="width: 100px;" panelheight="auto">
                        <option value="-1">全部</option>
                        <option value="25">25年</option>
                        <option value="24">24年</option>
                        <option value="23">23年</option>
                        <option value="22">22年</option>
                        <option value="0">半年前</option>
                        <option value="3">30周前</option>
                        <option value="4">9个月前</option>
                        <option value="2">10个月前</option>
                        <option value="1">一年前</option>
                    </select>
                </td>
            </tr>
        </table>
    </div>
    <input type="hidden" id="HiddenHouseID" />
    <table id="dg" class="easyui-datagrid">
    </table>
    <div id="toolbar">
        <a href="#" class="easyui-linkbutton" iconcls="icon-search" plain="false" onclick="dosearch()">&nbsp;查&nbsp;询&nbsp;</a>&nbsp;&nbsp;
        <a href="#" id="btnAdd" class="easyui-linkbutton" iconcls="icon-add" plain="false" onclick="addItem()">&nbsp;新&nbsp;增&nbsp;</a>&nbsp;&nbsp;
        <a href="#" id="btnUpdate" class="easyui-linkbutton" iconcls="icon-edit" plain="false" onclick="editItem()">&nbsp;修&nbsp;改&nbsp;</a>&nbsp;&nbsp;
        <a href="#" id="btnDel" class="easyui-linkbutton" iconcls="icon-cut" plain="false" onclick="DelItem()">&nbsp;删&nbsp;除&nbsp;</a>&nbsp;&nbsp;
        <a href="#" id="btnCopy" class="easyui-linkbutton" iconcls="icon-page_copy" plain="false" onclick="CopyPro()">&nbsp;复&nbsp;制&nbsp;</a>&nbsp;&nbsp;
        <a href="#" id="btnIn" class="easyui-linkbutton" iconcls="icon-in_cargo" plain="false" onclick="inCargo()">&nbsp;入&nbsp;库&nbsp;</a>&nbsp;&nbsp;
        <a href="#" id="btnLotinIn" class="easyui-linkbutton" iconcls="icon-in_cargo" plain="false" onclick="LotinCargo()">&nbsp;批量入库&nbsp;</a>&nbsp;&nbsp;
        <a href="#" id="btnCancleIn" class="easyui-linkbutton" iconcls="icon-out_cargo" plain="false" onclick="cancleCargo()">&nbsp;撤销入库&nbsp;</a>&nbsp;&nbsp;
        <a href="#" id="btnPrint" class="easyui-linkbutton" iconcls="icon-print" plain="false" onclick="printCargoAwb()">&nbsp;打印入库单&nbsp;</a>&nbsp;&nbsp;
        <a href="#" id="btnTag" class="easyui-linkbutton" iconcls="icon-tag_blue" plain="false" onclick="queryTag()">&nbsp;查看标签&nbsp;</a>&nbsp;&nbsp;<a href="#" class="easyui-linkbutton" iconcls="icon-lock_add"
            plain="false" onclick="lockStock()" id="IsLockStock">&nbsp;锁定库存&nbsp;</a>

        <table style="display: inline;">
            <tr>
                <td bgcolor="#d1eeee" height="15" width="15"></td>
                <td>未入库</td>
                <td bgcolor="#f7e9ee" height="15" width="15"></td>
                <td>锁定库存</td>
                <%-- <td bgcolor="#CDC5BF" height="15" width="15"></td>
                <td>：表示已出完</td>--%>
            </tr>
        </table>
    </div>
    <!--Begin 新增修改产品操作-->

    <div id="dlg" class="easyui-dialog" style="width: 700px; height: 490px; padding: 1px 1px"
        closed="true" buttons="#dlg-buttons">
        <div id="saPanel">
            <form id="fm" class="easyui-form" method="post">
                <input type="hidden" name="ProductID" />
                <table>
                    <tr>
                        <td>
                            <table>
                                <tr id="Y21">
                                    <td style="text-align: right;">产品名称:
                                    </td>
                                    <td>
                                        <input name="ProductName" id="ProductName" class="easyui-textbox" data-options="prompt:'请输入产品名称',required:true"
                                            style="width: 200px;">
                                    </td>

                                </tr>
                                <tr>
                                    <td style="text-align: right;">一级分类:
                                    </td>
                                    <td>
                                        <input id="ParentID" name="ParentID" class="easyui-combobox" style="width: 200px;" data-options="required:true"
                                            panelheight="auto" />
                                    </td>
                                </tr>
                                <tr>
                                    <td style="text-align: right;">二级分类:
                                    </td>
                                    <td>
                                        <input id="TypeID" name="TypeID" class="easyui-combobox" style="width: 200px;" data-options="valueField:'TypeID',textField:'TypeName',editable:true,required:true" />
                                    </td>
                                </tr>
                                <tr id="Y22">
                                    <td style="text-align: right;" id="lSpecs">产品规格:
                                    </td>
                                    <td>
                                        <input name="Specs" id="Specs" class="easyui-textbox" data-options="required:true"
                                            style="width: 200px;">
                                    </td>
                                </tr>
                                <tr id="Y23">
                                    <td style="text-align: right;" id="lModel">产品型号:
                                    </td>
                                    <td>
                                        <input name="Model" id="Model" class="easyui-textbox" data-options="required:true"
                                            style="width: 200px;">
                                    </td>
                                </tr>
                                <tr id="Y24">
                                    <td style="text-align: right;" id="lGoodsCode">货品代码:
                                    </td>
                                    <td>
                                        <input name="GoodsCode" id="GoodsCode" class="easyui-textbox" data-options="required:true"
                                            style="width: 200px;">
                                    </td>
                                </tr>
                                <tr id="Y25">
                                    <td style="text-align: right;" id="lFigure">轮胎花纹:
                                    </td>
                                    <td>
                                        <input name="Figure" id="Figure" class="easyui-textbox" data-options="required:true"
                                            style="width: 200px;">
                                    </td>
                                </tr>

                                <tr id="Y1">
                                    <td style="text-align: right;">子午线:
                                    </td>
                                    <td>
                                        <input name="Meridian" id="Meridian" class="easyui-textbox" data-options="prompt:'请输入子午线'"
                                            style="width: 200px;">
                                    </td>
                                </tr>
                                <tr id="Y2">
                                    <td style="text-align: right;">胎面宽度:
                                    </td>
                                    <td>
                                        <input name="TreadWidth" id="TreadWidth" class="easyui-numberbox" data-options="min:0,precision:0"
                                            style="width: 200px;">
                                    </td>
                                </tr>
                                <tr id="Y3">
                                    <td style="text-align: right;">轮胎扁平比:
                                    </td>
                                    <td>
                                        <input name="FlatRatio" id="FlatRatio" class="easyui-numberbox" data-options="min:0,precision:0"
                                            style="width: 200px;">
                                    </td>
                                </tr>
                                <tr id="Y4">
                                    <td style="text-align: right;">轮毂直径:
                                    </td>
                                    <td>
                                        <input name="HubDiameter" id="HubDiameter" class="easyui-numberbox" data-options="min:0,precision:0"
                                            style="width: 200px;">
                                    </td>
                                </tr>
                                <tr id="Y5">
                                    <td style="text-align: right;">载重指数:
                                    </td>
                                    <td>
                                        <input name="LoadIndex" id="LoadIndex" class="easyui-textbox" data-options="min:0,precision:0"
                                            style="width: 200px;">
                                    </td>
                                </tr>
                                <tr id="Y6">
                                    <td style="text-align: right;">速度级别:
                                    </td>
                                    <td>
                                        <input class="easyui-combobox" name="SpeedLevel" id="SpeedLevel" data-options="url:'../Data/TyreSpeedLevel.json',method:'get',valueField:'id',textField:'text'"
                                            style="width: 200px;">
                                    </td>
                                </tr>
                                <tr id="Y7">
                                    <td style="text-align: right;">产地:
                                    </td>
                                    <td>
                                        <select class="easyui-combobox" id="Born" name="Born" style="width: 200px;"
                                            panelheight="auto">
                                            <option value="0">国产</option>
                                            <option value="1">进口</option>
                                        </select>
                                    </td>
                                </tr>
                                <tr id="Y20">
                                    <td style="text-align: right;">归属部门:
                                    </td>
                                    <td>
                                        <%--<input id="BelongDepart" name="BelongDepart" class="easyui-combobox" style="width: 200px;" data-options="valueField:'ID',textField:'DepName',editable:false" />--%>
                                        <select class="easyui-combobox" id="BelongDepart" name="BelongDepart" style="width: 200px;" panelheight="auto" editable="true">
                                            <option value="0">RE渠道销售部</option>
                                            <option value="1">OE渠道销售部</option>
                                        </select>
                                    </td>
                                </tr>
                                <tr id="Y16">
                                    <td style="text-align: right;">供应商:
                                    </td>
                                    <td>
                                        <input id="Supplier" name="Supplier" style="width: 200px;" class="easyui-combobox AcceptPeople" data-options="valueField:'ClientNum',textField:'ClientName',editable:true" />
                                        <%--<input name="Supplier" id="Supplier" class="easyui-textbox" style="width: 200px;" />--%>
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td style="vertical-align: top">
                            <table>
                                <tr>
                                    <td style="text-align: right;">批次:
                                    </td>
                                    <td>
                                        <input name="Batch" id="Batch" class="easyui-textbox" data-options="prompt:'请输入批次',required:true"
                                            style="width: 200px;">
                                    </td>
                                </tr>
                                <tr id="Y8">
                                    <td style="text-align: right;" id="lSize">尺寸:
                                    </td>
                                    <td>
                                        <input name="Size" id="Size" class="easyui-textbox" data-options="prompt:'请输入尺寸'"
                                            style="width: 200px;">
                                    </td>
                                </tr>
                                <tr>
                                    <td style="text-align: right;">数量:
                                    </td>
                                    <td>
                                        <input name="Numbers" id="Numbers" class="easyui-numberbox" data-options="min:0,precision:0"
                                            style="width: 200px;">
                                    </td>
                                </tr>
                                <tr id="Y17">
                                    <td style="text-align: right;" id="lUnitPrice">单价:
                                    </td>
                                    <td>
                                        <input name="UnitPrice" id="UnitPrice" class="easyui-numberbox" readonly="readonly" data-options="min:0,precision:2"
                                            style="width: 200px;">
                                    </td>
                                </tr>
                                <tr id="Y37">
                                    <td style="text-align: right;" id="lNextDayPrice">次日达价:
                                    </td>
                                    <td>
                                        <input name="NextDayPrice" id="NextDayPrice" class="easyui-numberbox" readonly="readonly" data-options="min:0,precision:2"
                                            style="width: 200px;">
                                    </td>
                                </tr>
                                <tr id="Y9">
                                    <td style="text-align: right;">重量:
                                    </td>
                                    <td>
                                        <input name="Weight" id="Weight" class="easyui-numberbox" data-options="min:0,precision:2"
                                            style="width: 200px;">KG
                                    </td>
                                </tr>
                                <tr id="Y18">
                                    <td style="text-align: right;" id="lTradePrice">门店价:
                                    </td>
                                    <td>
                                        <input name="TradePrice" id="TradePrice" class="easyui-numberbox" readonly="readonly" data-options="min:0,precision:2"
                                            style="width: 200px;">
                                    </td>
                                </tr>
                                <tr id="Y19">
                                    <td style="text-align: right;" id="lSalePrice">销售价:
                                    </td>
                                    <td>
                                        <input name="SalePrice" id="SalePrice" class="easyui-numberbox" readonly="readonly" data-options="min:0,precision:2"
                                            style="width: 200px;">
                                    </td>
                                </tr>
                                <tr id="Y26">
                                    <td style="text-align: right;">产品包装:
                                    </td>
                                    <td>
                                        <input class="easyui-combobox" name="Package" id="Package" data-options="url:'../Data/Package.json',method:'get',valueField:'id',textField:'text',panelHeight:'auto'"
                                            style="width: 200px;">
                                    </td>
                                </tr>
                                <tr id="Y10">
                                    <td style="text-align: right;">包装数量:
                                    </td>
                                    <td>
                                        <input name="PackageNum" id="PackageNum" class="easyui-numberbox" data-options="min:0,precision:0"
                                            style="width: 200px;">
                                    </td>
                                </tr>
                                <tr id="Y11">
                                    <td style="text-align: right;">包装重量:
                                    </td>
                                    <td>
                                        <input name="PackageWeight" id="PackageWeight" class="easyui-numberbox" data-options="min:0,precision:2"
                                            style="width: 200px;">KG
                                    </td>
                                </tr>
                                <tr id="Y12">
                                    <td style="text-align: right;">产品来源:
                                    </td>
                                    <td>
                                        <%--<input class="easyui-combobox" name="Source" id="Source" data-options="url:'../Data/ProductSource.json',method:'get',valueField:'id',textField:'text'"
                                            style="width: 200px;">--%>
                                        <input id="Source" name="Source" class="easyui-combobox" style="width: 200px;" data-options="valueField:'Source',textField:'SourceName',editable:false,required:true" />
                                    </td>
                                </tr>
                                <tr id="Y13">
                                    <td style="text-align: right;">来货单号:
                                    </td>
                                    <td>
                                        <input name="SourceOrderNo" id="SourceOrderNo" class="easyui-textbox" style="width: 200px;" />
                                    </td>
                                </tr>
                                <tr id="Y27">
                                    <td style="text-align: right;">订单归属月:
                                    </td>
                                    <td>
                                        <input name="BelongMonth" id="BelongMonth" class="easyui-datebox" data-options="prompt:'请输入订单归属月',required:true" style="width: 200px" />
                                    </td>
                                </tr>
                                <tr id="Y15">
                                    <td style="text-align: right;">OERE:
                                    </td>
                                    <td>
                                        <select class="easyui-combobox" id="Assort" name="Assort" style="width: 200px;"
                                            panelheight="auto">
                                            <option value="OER">OER</option>
                                            <option value="REP">REP</option>
                                        </select>
                                    </td>
                                </tr>

                            </table>
                        </td>
                    </tr>
                </table>
            </form>
        </div>
    </div>
    <div id="dlg-buttons">
        <a href="#" class="easyui-linkbutton" id="btnSave" iconcls="icon-ok" onclick="saveItem()">&nbsp;保&nbsp;存&nbsp;</a>&nbsp;&nbsp;&nbsp;&nbsp;
        <a href="#" class="easyui-linkbutton" iconcls="icon-cancel" onclick="javascript:$('#dlg').dialog('close')">&nbsp;取&nbsp;消&nbsp;</a>
    </div>
    <!--End 新增修改产品操作-->

    <!--Begin 入库操作-->
    <div id="inCargo" class="easyui-dialog" style="width: 800px; height: 430px; padding: 2px 2px"
        closed="true" buttons="#inCargo-buttons">
        <div id="saPanel" class="easyui-panel" title="" data-options="iconCls:'icon-search'">
            <table>
                <tr>
                    <td style="text-align: right;">货位代码:
                    </td>
                    <td>
                        <input id="CCode" class="easyui-textbox" data-options="prompt:'请输入货位代码'" style="width: 100px">
                    </td>
                    <%--<td style="text-align: right;">货位类型:
                    </td>
                    <td>
                        <input class="easyui-combobox" id="CType" data-options="url:'../Data/ContainerType.json',method:'get',valueField:'id',textField:'text',panelHeight:'auto'"
                            style="width: 60px;">
                    </td>--%>
                    <td style="text-align: right;">区域大仓:
                    </td>
                    <td>
                        <input id="HID" class="easyui-combobox" style="width: 80px;" panelheight="auto" data-options="editable:false,required:true" />
                    </td>
                    <td style="text-align: right;">所在仓库:
                    </td>
                    <td>
                        <input id="AAHID" class="easyui-combobox" style="width: 80px;" data-options="valueField:'AreaID',textField:'Name',editable:false,required:true" panelheight="auto" />
                    </td>
                    <td style="text-align: right;">所在区域:
                    </td>
                    <td>
                        <input id="PID" class="easyui-combobox" style="width: 80px;" data-options="valueField:'AreaID',textField:'Name',editable:false" panelheight="auto" />
                    </td>
                    <%--<td style="text-align: right;">星级:
                    </td>
                    <td>
                        <input class="easyui-combobox" id="CStar" data-options="url:'../Data/StarLevel.json',method:'get',valueField:'id',textField:'text',panelHeight:'auto'"
                            style="width: 50px;"></td>--%>
                    <td><a href="#" class="easyui-linkbutton" iconcls="icon-search" plain="false" onclick="queryPosition()">&nbsp;查&nbsp;询&nbsp;</a></td>
                </tr>
            </table>
        </div>
        <form id="fmCargo" class="easyui-form" method="post">
            <input type="hidden" name="ProductID" id="CProductID" />
            <input type="hidden" name="TypeID" id="CTypeID" />
            <input type="hidden" name="Model" id="CModel" />
            <input type="hidden" name="Specs" id="CSpecs" />
            <input type="hidden" name="Figure" id="CFigure" />
            <input type="hidden" name="LoadIndex" id="CLoadIndex" />
            <input type="hidden" name="SpeedLevel" id="CSpeedLevel" />
            <input type="hidden" name="Batch" id="CBatch" />
            <input type="hidden" name="Source" id="CSource" />

        </form>
        <table id="dgInCargo" class="easyui-datagrid">
        </table>
        <div id="saPanel" class="easyui-panel" title="" data-options="iconCls:'icon-search'">
            <table>
                <tr>
                    <td>入库产品：</td>
                    <td>
                        <input id="HProduct" class="easyui-textbox" style="width: 100px" readonly="readonly"></td>
                    <td>入库件数：</td>
                    <td>
                        <input id="HPiece" class="easyui-textbox" style="width: 100px;" readonly="readonly"></td>
                    <td style="font-size: 14px; font-weight: bold; color: red">已拉件数：</td>
                    <td>
                        <input id="YesPiece" class="easyui-textbox" style="width: 100px" readonly="readonly"></td>
                    <td style="font-size: 14px; font-weight: bold; color: red">未拉件数：</td>
                    <td>
                        <input id="NoPiece" class="easyui-textbox" style="width: 100px" readonly="readonly"></td>
                </tr>
            </table>
        </div>
    </div>
    <div id="inCargo-buttons">
        <a href="#" class="easyui-linkbutton" iconcls="icon-ok" onclick="saveInCargo()">&nbsp;保&nbsp;存&nbsp;</a>
        <a href="#" class="easyui-linkbutton" iconcls="icon-cancel" onclick="closeIncargoDialog()">&nbsp;取&nbsp;消&nbsp;</a>
    </div>
    <!--End 入库操作-->
    <!--Begin 批量入库操作-->
    <div id="dlgLotInCargom" class="easyui-dialog" style="width: 800px; height: 200px; padding: 2px 2px"
        closed="true" buttons="#dlgLotInCargom-buttons">
        <div id="saPanel" class="easyui-panel" title="">
            <table>
                <tr>
                    <td style="text-align: right;">区域大仓:
                    </td>
                    <td>
                        <input id="LOTHID" class="easyui-combobox" style="width: 100px;" readonly="readonly" panelheight="auto" />
                    </td>
                    <td style="text-align: right;">所属仓库:
                    </td>
                    <td>
                        <input id="LOTPID" class="easyui-combobox" style="width: 100px;" data-options="valueField:'AreaID',textField:'Name'"
                            panelheight="auto" />
                    </td>
                    <td style="text-align: right;">一级区域:
                    </td>
                    <td>
                        <input id="LOTSID" class="easyui-combobox" style="width: 100px;" data-options="valueField:'AreaID',textField:'Name'"
                            panelheight="auto" />
                    </td>
                    <td style="text-align: right;">所有货位:
                    </td>
                    <td>
                        <input id="LOTContainer" class="easyui-combobox" style="width: 100px;" data-options="valueField:'ContainerID',textField:'ContainerCode'"
                            panelheight="200" />
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div id="dlgLotInCargom-buttons">
        <a href="#" class="easyui-linkbutton" iconcls="icon-ok" onclick="saveLotInCargo()">&nbsp;保&nbsp;存&nbsp;</a>
        <a href="#" class="easyui-linkbutton" iconcls="icon-cancel" onclick="javascript:$('#dlgLotInCargom').dialog('close')">&nbsp;取&nbsp;消&nbsp;</a>
    </div>
    <!--Begin 批量入库操作-->
    <!--Begin 打印入库单-->
    <div id="printInCargoAwb" class="easyui-dialog" style="width: 1000px; height: 520px; padding: 2px 2px"
        closed="true" buttons="#printInCargoAwb-buttons">
        <div id="saPanel" class="easyui-panel" title="" data-options="iconCls:'icon-search'">
            <table>
                <tr>
                    <td style="text-align: right;">入库时间:
                    </td>
                    <td>
                        <input id="CStartDate" class="easyui-datebox" style="width: 100px">~
                    <input id="CEndDate" class="easyui-datebox" style="width: 100px">
                    </td>
                    <td style="text-align: right;">打印状态:
                    </td>
                    <td>
                        <select class="easyui-combobox" id="CIsPrintInCargo" style="width: 80px;" panelheight="auto">
                            <option value="-1">全部</option>
                            <option value="0">未打印</option>
                            <option value="1">已打印</option>
                        </select>
                    </td>
                    <td style="text-align: right;">入库类型:
                    </td>
                    <td>
                        <select class="easyui-combobox" id="CInHouseType" style="width: 100px;" panelheight="auto">
                            <option value="-1">全部</option>
                            <option value="0">正常进货入库</option>
                            <option value="1">退货入库</option>
                            <option value="2">订单删除入库</option>
                            <option value="3">订单拉下入库</option>
                        </select>
                    </td>
                    <td style="text-align: right;">区域大仓:
                    </td>
                    <td>
                        <input id="InID" class="easyui-combobox" data-options="required:true" style="width: 80px;" panelheight="auto" />
                    </td>
                    <td style="text-align: right;">所属仓库:
                    </td>
                    <td>
                        <input id="InHID" class="easyui-combobox" style="width: 80px;" data-options="valueField:'AreaID',textField:'Name'" panelheight="auto" />
                    </td>
                    <td><a href="#" class="easyui-linkbutton" iconcls="icon-search" plain="false" onclick="searchInCargoPrint()">&nbsp;查&nbsp;询&nbsp;</a></td>
                </tr>
            </table>
        </div>
        <table id="dgPrintInCargo" class="easyui-datagrid">
        </table>
        <div id="printInCargoAwb-buttons">
            <a href="#" class="easyui-linkbutton" iconcls="icon-print" onclick="btnprintCargoAwb()">&nbsp;打&nbsp;印&nbsp;</a>
            <a href="#" class="easyui-linkbutton" iconcls="icon-cancel" onclick="javascript:$('#printInCargoAwb').dialog('close')">&nbsp;取&nbsp;消&nbsp;</a>
        </div>
    </div>
    <!--End 打印入库单-->
    <!--Begin 查询产品标签列表-->
    <div id="productTag" class="easyui-dialog" style="width: 1200px; height: 520px; padding: 0px"
        closed="true" buttons="#productTag-buttons">
        <table id="dgTag" class="easyui-datagrid">
        </table>
        <div id="productTag-buttons">
            <a href="#" class="easyui-linkbutton" iconcls="icon-out_cargo" plain="false" onclick="cancelTagInCargo()">&nbsp;撤销标签&nbsp;</a>&nbsp;&nbsp;
            <a href="#" class="easyui-linkbutton" id="btnUnOutCargo" iconcls="icon-edit"
                plain="false" onclick="SetUnOutCargo()">&nbsp;设置未出库&nbsp;</a>&nbsp;&nbsp;
            <a href="#" class="easyui-linkbutton" iconcls="icon-cancel" onclick="javascript:$('#productTag').dialog('close')">&nbsp;关&nbsp;闭&nbsp;</a>
        </div>
    </div>
    <!--End 查询产品标签列表-->
    <!--Begin 复制产品数据修改数量-->
    <div id="dlgUpInNum" class="easyui-dialog" style="width: 400px; height: 250px; padding: 5px 5px"
        closed="true" buttons="#dlgUpInNum-buttons">
        <form id="fmUpInNum" class="easyui-form" method="post">
            <input type="hidden" name="ProductID" id="DProductID" />
            <table>
                <tr>
                    <td style="text-align: right;">添加产品数量:
                    </td>
                    <td>
                        <input name="Numbers" id="DNumbers" class="easyui-numberbox" style="width: 200px;" />
                    </td>
                </tr>
                <tr>
                    <td style="text-align: right;">批次:
                    </td>
                    <td>
                        <input name="Batch" id="DBatch" class="easyui-textbox" data-options="prompt:'请输入批次',required:true"
                            style="width: 200px;" />
                    </td>
                </tr>
                <%--   <tr>
                    <td style="text-align: right;">成本价:
                    </td>
                    <td>
                        <input name="CostPrice" id="ACostPrice" class="easyui-numberbox" data-options="min:0,precision:2"
                            style="width: 200px;">
                    </td>
                </tr>--%>
                <tr>
                    <td style="text-align: right;">复制到:
                    </td>
                    <td>
                        <input id="CHouseID" name="HouseID" class="easyui-combobox" data-options="prompt:'请选择区域大仓',required:true" style="width: 200px;" />
                    </td>
                </tr>
                <tr>
                    <td style="text-align: right;">产品来源:
                    </td>
                    <td>
                        <%--<input class="easyui-combobox" name="Source" id="ASource" data-options="url:'../Data/ProductSource.json',method:'get',valueField:'id',textField:'text',panelHeight:'auto'"
                            style="width: 200px;">--%>
                        <input id="ASource" name="Source" class="easyui-combobox" style="width: 200px;" data-options="valueField:'Source',textField:'SourceName',editable:false,required:true" />
                    </td>
                </tr>
                <tr>
                    <td style="text-align: right;">来货单号:
                    </td>
                    <td>
                        <input name="SourceOrderNo" id="ASourceOrderNo" class="easyui-textbox"
                            style="width: 200px;">
                    </td>
                </tr>
                <tr>
                    <td style="text-align: right;">订单归属月:
                    </td>
                    <td>
                        <input name="BelongMonth" id="ABelongMonth" class="easyui-datebox" style="width: 100px" />
                    </td>
                </tr>
            </table>
        </form>
    </div>
    <div id="dlgUpInNum-buttons">
        <a href="#" class="easyui-linkbutton" iconcls="icon-ok" onclick="CopyProduct()">&nbsp;确&nbsp;定&nbsp;</a>
        <a href="#" class="easyui-linkbutton" iconcls="icon-cancel" onclick="javascript:$('#dlgUpInNum').dialog('close')">&nbsp;取&nbsp;消&nbsp;</a>
    </div>
    <!--End 复制产品数据修改数量-->
    <object id="LODOP_OB" title="dd" classid="clsid:2105C259-1E0C-4534-8141-A753534CB4CA"
        width="0px" height="0px">
        <embed id="LODOP_EM" type="application/x-print-lodop" width="0px" height="0px"></embed>
    </object>
    <script type="text/javascript">
        //根据公司部门ID获取部门名称
        function GetUpClientDepName(value) {
            var name = '';
            if (value != "") {
                for (var i = 0; i < UpClientDep.length; i++) {
                    if (UpClientDep[i].ID == value) {
                        name = UpClientDep[i].DepName;
                        break;
                    }
                }
            }
            return name;
        };
        //锁定库存
        function lockStock() {
            var rows = $('#dg').datagrid('getSelections');
            if (rows == null || rows == "") {
                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '请选择要操作的数据！', 'warning');
                return;
            }
            $.messager.confirm('<%= Cargo.Common.GetSystemNameAndVersion()%>', '确定锁定该产品库存？', function (r) {
                if (r) {
                    var json = JSON.stringify(rows)
                    $.ajax({
                        url: 'productApi.aspx?method=LockStockCargoProduct',
                        type: 'post', dataType: 'json', data: { data: json },
                        success: function (text) {
                            //var result = eval('(' + msg + ')');
                            if (text.Result == true) {
                                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '锁定成功!', 'info');
                                $('#dg').datagrid('reload');
                            }
                            else {
                                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', text.Message, 'warning');
                            }
                        }
                    });
                }
            });
        }

        <%--根据来源ID获取来源名称--%>
        function GetSourceName(value) {
            var name = '';
            for (var i = 0; i < ProductSource.length; i++) {
                if (ProductSource[i].Source == value) {
                    name = ProductSource[i].SourceName;
                    break;
                }
            }
            return name;
        }
        //撤销标签入库
        function cancelTagInCargo() {
            var rows = $('#dgTag').datagrid('getSelections');
            if (rows == null || rows == "") {
                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '请选择要撤销的标签数据！', 'warning');
                return;
            }
            $.messager.confirm('<%= Cargo.Common.GetSystemNameAndVersion()%>', '确定撤销该标签入库？', function (r) {
                if (r) {
                    $.messager.progress({ msg: '请稍后,正在撤销中...' });
                    var json = JSON.stringify(rows)
                    $.ajax({
                        url: 'productApi.aspx?method=CancelTagInCargo',
                        type: 'post', dataType: 'json', data: { data: json },
                        success: function (text) {
                            $.messager.progress("close");
                            $('#dgTag').datagrid('clearSelections');
                            if (text.Result == true) {
                                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '标签撤销成功!', 'info');
                                $('#dgTag').datagrid('reload');
                            }
                            else {
                                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', text.Message, 'warning');
                            }
                        }
                    });
                }
            });
        }
        //保存批量入库
        function saveLotInCargo() {
            var LOTContainer = $('#LOTContainer').combobox('getValue');
            if (LOTContainer == undefined || LOTContainer == '' || LOTContainer == '0') {
                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '请选择批量入库的货位！', 'warning'); return;
            }
            var rows = $('#dg').datagrid('getSelections');
            $.messager.confirm('<%= Cargo.Common.GetSystemNameAndVersion()%>', '确定批量入库？', function (r) {
                if (r) {
                    $.messager.progress({ msg: '请稍后,正在保存中...' });
                    var json = JSON.stringify(rows)
                    $.ajax({
                        url: 'productApi.aspx?method=saveLotInCargo',
                        type: 'post', dataType: 'json', data: { data: json, LOTContainer: LOTContainer },
                        success: function (text) {
                            $.messager.progress("close");
                            if (text.Result == true) {
                                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '批量入库成功!', 'info');
                                $('#dlgLotInCargom').dialog('close');
                                dosearch();
                            }
                            else {
                                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', text.Message, 'warning');
                            }
                        }
                    });
                }
            });
        }
        //批量入库
        function LotinCargo() {
            var row = $('#dg').datagrid('getSelected');
            if (row == null || row == "") { $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '请选择要批量入库的数据！', 'warning'); return; }
            if (row) {
                $('#dlgLotInCargom').dialog('open').dialog('setTitle', '产品批量入库');
                //所在仓库
                $('#LOTHID').combobox({
                    url: '../House/houseApi.aspx?method=CargoPermisionHouse',
                    valueField: 'HouseID', textField: 'Name',
                    onSelect: function (rec) {
                        $('#LOTPID').combobox('clear');
                        var url = '../House/houseApi.aspx?method=QueryALLArea&pid=0&hid=' + rec.HouseID;
                        $('#LOTPID').combobox('reload', url);
                        //一级仓库
                        $('#LOTPID').combobox({
                            onSelect: function (fai) {
                                $('#LOTSID').combobox('clear');
                                var url = '../House/houseApi.aspx?method=QueryALLArea&hid=' + rec.HouseID + '&pid=' + fai.AreaID;
                                $('#LOTSID').combobox('reload', url);
                                $('#LOTSID').combobox({
                                    onSelect: function (con) {
                                        $('#LOTContainer').combobox('clear');
                                        var url = '../House/houseApi.aspx?method=QueryContainerByAreaID&FirstID=' + rec.HouseID + '&HID=' + fai.AreaID + '&SID=' + con.AreaID;
                                        $('#LOTContainer').combobox('reload', url);
                                    }
                                });
                            }
                        });
                    }
                });

                $('#LOTHID').combobox('setValue', '<%=UserInfor.HouseID%>');
                $('#LOTPID').combobox('clear');
                var url = '../House/houseApi.aspx?method=QueryALLArea&pid=0&hid=<%=UserInfor.HouseID%>';
                $('#LOTPID').combobox('reload', url);
                //一级仓库
                $('#LOTPID').combobox({
                    onSelect: function (fai) {
                        $('#LOTSID').combobox('clear');
                        var url = '../House/houseApi.aspx?method=QueryALLArea&hid=<%=UserInfor.HouseID%>&pid=' + fai.AreaID;
                        $('#LOTSID').combobox('reload', url);
                        $('#LOTSID').combobox({
                            onSelect: function (con) {
                                $('#LOTContainer').combobox('clear');
                                var url = '../House/houseApi.aspx?method=QueryContainerByAreaID&FirstID=<%=UserInfor.HouseID%>&HID=' + fai.AreaID + '&SID=' + con.AreaID;
                                $('#LOTContainer').combobox('reload', url);
                            }
                        });
                    }
                });
            }
        }
        //设置选中数据为未出库
        function SetUnOutCargo() {
            var rows = $('#dgTag').datagrid('getSelections');
            if (rows == null || rows == "") {
                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '请选择要修改的数据！', 'warning');
                return;
            }
            $.messager.confirm('<%= Cargo.Common.GetSystemNameAndVersion()%>', '确定设置该标签为未出库？', function (r) {
                if (r) {
                    var json = JSON.stringify(rows)
                    $.ajax({
                        url: 'productApi.aspx?method=SetTagUnOutCargo',
                        type: 'post', dataType: 'json', data: { data: json },
                        success: function (text) {
                            //var result = eval('(' + msg + ')');
                            if (text.Result == true) {
                                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '设置成功!', 'info');
                                $('#dgTag').datagrid('reload');
                            }
                            else {
                                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', text.Message, 'warning');
                            }
                        }
                    });
                }
            });
        }
        //查询产品标签数据列表 
        function queryTag() {
            var row = $('#dg').datagrid('getSelected');
            if (row == null || row == "") {
                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '请选择要查询标签的产品！', 'warning');
                return;
            }
            if (row) {
                $('#productTag').dialog('open').dialog('setTitle', '查询产品：' + row.Specs + '标签列表');
                showTagGrid(row.HouseID);
                $('#dgTag').datagrid('clearSelections');
                var gridOpts = $('#dgTag').datagrid('options');
                gridOpts.url = '../Product/productApi.aspx?method=QueryTagByProductID&ProductID=' + row.ProductID + '&ContainerID=' + row.ContainerID;
                $('#btnUnOutCargo').hide();
                var isAdmin = "<%=UserInfor.IsAdmin%>";
                if (isAdmin == "1") {
                    $('#btnUnOutCargo').show();
                }
            }
        }
        //标签数据列表
        function showTagGrid(houseID) {
            var columns = [];
            if (houseID == "47") {
                columns.push({ title: '', field: 'ProductID', checkbox: true, width: '30px' });
                columns.push({ title: '产品名称', field: 'ProductName', width: '80px' });
                columns.push({ title: '规格', field: 'Specs', width: '80px' });
                columns.push({ title: '长和编码', field: 'Figure', width: '80px' });
                columns.push({ title: '标签编码', field: 'TagCode', width: '90px' });
                columns.push({ title: '货位代码', field: 'ContainerCode', width: '80px' });
                columns.push({
                    title: '入库状态', field: 'InCargoStatus', width: '60px',
                    formatter: function (val, row, index) { if (val == "0") { return "未入库"; } else if (val == "1") { return "已入库"; } else { return "未入库"; } }
                });
                columns.push({
                    title: '入库类型', field: 'InCargoType', width: '60px',
                    formatter: function (val, row, index) { if (val == "0") { return "进货扫描入库"; } else if (val == "1") { return "退货入库"; } else if (val == "2") { return "删除订单入库"; } else if (val == "3") { return "拉下订单入库"; } else if (val == "4") { return "复盘入库"; } else { return "进货扫描入库"; } }
                });
                columns.push({ title: '入库时间', field: 'InCargoTime', width: '120px', formatter: DateTimeFormatter });
                columns.push({ title: '入库操作人', field: 'InCargoOperID', width: '60px' });
                columns.push({
                    title: '出库状态', field: 'OutCargoStatus', width: '60px',
                    formatter: function (val, row, index) { if (val == "0") { return "未出库"; } else if (val == "1") { return "已出库"; } else { return "未出库"; } }
                });
                columns.push({ title: '出库时间', field: 'OutCargoTime', width: '120px', formatter: DateTimeFormatter });
                columns.push({ title: '出库操作人', field: 'OutCargoOperID', width: '60px' });
                columns.push({ title: '出库订单号', field: 'OrderNo', width: '80px' });
                columns.push({ title: '轮胎编码', field: 'TyreCode', width: '100px' });
            } else {
                columns.push({ title: '', field: 'ProductID', checkbox: true, width: '30px' });
                //columns.push({ title: '产品名称', field: 'ProductName', width: '80px' });
                columns.push({ title: '规格', field: 'Specs', width: '80px' });
                columns.push({ title: '花纹', field: 'Figure', width: '85px' });
                columns.push({ title: '标签编码', field: 'TagCode', width: '95px' });
                columns.push({ title: '轮胎编码', field: 'TyreCode', width: '95px' });
                columns.push({ title: '货位代码', field: 'ContainerCode', width: '80px' });
                columns.push({
                    title: '入库状态', field: 'InCargoStatus', width: '60px',
                    formatter: function (val, row, index) { if (val == "0") { return "未入库"; } else if (val == "1") { return "已入库"; } else { return "未入库"; } }
                });
                columns.push({
                    title: '入库类型', field: 'InCargoType', width: '60px',
                    formatter: function (val, row, index) { if (val == "0") { return "进货扫描入库"; } else if (val == "1") { return "退货入库"; } else if (val == "2") { return "删除订单入库"; } else if (val == "3") { return "拉下订单入库"; } else if (val == "4") { return "复盘入库"; } else { return "进货扫描入库"; } }
                });
                columns.push({ title: '入库时间', field: 'InCargoTime', width: '120px', formatter: DateTimeFormatter });
                columns.push({ title: '入库操作人', field: 'InCargoOperID', width: '60px' });
                columns.push({
                    title: '出库状态', field: 'OutCargoStatus', width: '60px',
                    formatter: function (val, row, index) { if (val == "0") { return "未出库"; } else if (val == "1") { return "已出库"; } else { return "未出库"; } }
                });
                columns.push({ title: '出库时间', field: 'OutCargoTime', width: '120px', formatter: DateTimeFormatter });
                columns.push({ title: '出库操作人', field: 'OutCargoOperID', width: '60px' });
                columns.push({ title: '出库订单号', field: 'OrderNo', width: '80px' });
            }
            $('#dgTag').datagrid({
                width: '100%',
                height: '440px',
                title: '', //标题内容
                rownumbers: true,
                loadMsg: '数据加载中请稍候...',
                autoRowHeight: false, //行高是否自动
                collapsible: false, //是否可折叠
                pagination: false, //分页是否显示
                fitColumns: false, //设置为 true，则会自动扩大或缩小列的尺寸以适应网格的宽度并且防止水平滚动
                singleSelect: false, //设置为 true，则只允许选中一行。
                checkOnSelect: true, //如果设置为 true，当用户点击某一行时，则会选中/取消选中复选框。如果设置为 false 时，只有当用户点击了复选框时，才会选中/取消选中复选框
                idField: 'TagCode',
                url: null,
                columns: [columns],
                onClickRow: function (index, row) {
                    $('#dgTag').datagrid('clearSelections');
                    $('#dgTag').datagrid('selectRow', index);
                }
            });
        }
        //撤销产品入库
        function cancleCargo() {
            var rows = $('#dg').datagrid('getSelections');
            if (rows == null || rows == "") {
                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '请选择要撤销的产品！', 'warning');
                return;
            }
            for (var i = 0; i < rows.length; i++) {
                if (rows[i].OperaType == 1) {
                    $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '所选数据中包含扫描入库数据请使用标签撤销入库！', 'warning'); return;
                }
                if (rows[i].InCargoStatus == 0) {
                    $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '所选数据中包含未入库数据！', 'warning'); return;
                }
            }
          <%--  if (rows.length > 1) {
                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '请选择一行数据！', 'warning'); return;
            }--%>
            $.messager.confirm('<%= Cargo.Common.GetSystemNameAndVersion()%>', '确定撤销已入库的产品？', function (r) {
                if (r) {
                    $.messager.progress({ msg: '请稍后,正在保存中...' });
                    var json = JSON.stringify(rows)
                    $.ajax({
                        url: 'productApi.aspx?method=CancleInCargo',
                        type: 'post', dataType: 'json', data: { data: json },
                        success: function (text) {
                            $.messager.progress("close");
                            //var result = eval('(' + msg + ')');
                            if (text.Result == true) {
                                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '撤销成功!', 'info');
                                $('#dg').datagrid('reload');
                            }
                            else {
                                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', text.Message, 'warning');
                            }
                        }
                    });
                }
            });
        }
        //保存复制产品数据
        function CopyProduct() {
            var rows = $('#dg').datagrid('getSelections');
            if (rows == null || rows == "") { $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '请选择要保存的数据！', 'warning'); return; }
                <%--var hous = '<%= HouseName%>';
                if (hous.indexOf("长沙") != -1 || hous.indexOf("武汉") != -1) {
                    if ($('#ACostPrice').numberbox('getValue') == "" || $('#ACostPrice').numberbox('getValue') == 0) {
                        $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '请输入产品成本价！', 'warning'); return;
                    }
                }--%>
            $.messager.confirm('<%= Cargo.Common.GetSystemNameAndVersion()%>', '确定保存？', function (r) {
                if (r) {
                    var json = JSON.stringify(rows);
                    $('#fmUpInNum').form('submit', {
                        url: 'productApi.aspx?method=CopyProduct',
                        contentType: "application/json;charset=utf-8", dataType: "json",
                        onSubmit: function (param) {
                            param.submitData = json;
                            var trd = $(this).form('enableValidation').form('validate');
                            return trd;
                        },
                        success: function (msg) {
                            var result = eval('(' + msg + ')');
                            if (result.Result) {
                                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '复制成功!', 'info');
                                $('#dlgUpInNum').dialog('close');
                                $('#dg').datagrid('reload');
                            } else { $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '复制失败：' + result.Message, 'warning'); }
                        }
                    })
                }
            });
        }
        //复制产品数据
        function CopyPro() {
            var rows = $('#dg').datagrid('getSelections');
            if (rows == null || rows == "") {
                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '请选择要复制的数据！', 'warning'); return;
            }
            if (rows.length > 1) {
                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '请选择一行数据！', 'warning'); return;
            }
            var row = $('#dg').datagrid('getSelected');
            if (row == null || row == "") {
                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '请选择要复制的数据！', 'warning'); return;
            }
            if (row) {
                $('#dlgUpInNum').dialog('open').dialog('setTitle', '复制产品型号：' + row.Model + '，规格：' + row.Specs + '，花纹：' + row.Figure);
                $('#fmUpInNum').form('clear');
                $('#DBatch').textbox('setValue', '');
                $('#DNumbers').numberbox('setValue', '');
                $('#DNumbers').numberbox({
                    min: 0,
                    max: 100000,
                    precision: 0
                });

                $('#CHouseID').combobox({
                    url: '../House/houseApi.aspx?method=CargoPermisionHouse',
                    valueField: 'HouseID', textField: 'Name'
                });
                $('#CHouseID').combobox('setValue', '<%=UserInfor.HouseID%>');
                var SourceUrl = '../Product/productApi.aspx?method=QueryAllProductSource';
                $('#ASource').combobox('reload', SourceUrl);

                $('#DProductID').val(row.ProductID);
                //$('#ACostPrice').numberbox('setValue', row.CostPrice);
                if (row.Source != "" && row.Source != "0") {
                    $('#ASource').combobox('setValue', row.Source);
                }
                $('#ASourceOrderNo').val(row.SourceOrderNo);
            }
        }
        //打印入库单btnprintCargoAwb
        function btnprintCargoAwb() {
            LODOP = getLodop(document.getElementById('LODOP_OB'), document.getElementById('LODOP_EM'));
            var nowdate = new Date();
            LODOP.SET_PRINT_PAGESIZE(0, 2100, 2970, "A4");
            var hous = '<%= HouseName%>';
            var com = '湖南省迪乐泰仓库入库单';
            if (hous.indexOf('湖北') != -1) {
                com = '湖北省迪乐泰仓库入库单';
            }
            if (hous.indexOf('西安') != -1) {
                com = '西安迪乐泰仓库入库单';
            }
            if (hous.indexOf('广州') != -1) {
                com = '广州迪乐泰仓库入库单';
            }
            if (hous.indexOf('梅州') != -1) {
                com = '梅州新陆程仓库入库单';
            }
            if (hous.indexOf('四川') != -1) {
                com = '四川迪乐泰仓库入库单';
            }
            if (hous.indexOf('富添盛') != -1) {
                com = '富添盛仓库入库单';
            }
            LODOP.ADD_PRINT_TEXT(4, 253, 485, 33, com);
            LODOP.SET_PRINT_STYLEA(0, "FontName", "新宋体");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 19);
            LODOP.SET_PRINT_STYLEA(0, "Bold", 1);
            LODOP.ADD_PRINT_IMAGE(-3, 47, 198, 49, "<img src=\"../CSS/image/dlqf.jpg\"/>");
            LODOP.SET_PRINT_STYLEA(0, "Stretch", 1);

            //LODOP.ADD_PRINT_RECT(48, 3, 76, 25, 0, 1);
            //LODOP.ADD_PRINT_RECT(48, 78, 77, 25, 0, 1);
            //LODOP.ADD_PRINT_RECT(48, 154, 78, 25, 0, 1);
            //LODOP.ADD_PRINT_RECT(48, 231, 60, 25, 0, 1);
            //LODOP.ADD_PRINT_RECT(48, 291, 64, 25, 0, 1);
            //LODOP.ADD_PRINT_RECT(48, 354, 63, 25, 0, 1);
            //LODOP.ADD_PRINT_RECT(48, 416, 50, 25, 0, 1);
            //LODOP.ADD_PRINT_RECT(48, 465, 60, 25, 0, 1);
            //LODOP.ADD_PRINT_RECT(48, 524, 90, 25, 0, 1);
            //LODOP.ADD_PRINT_RECT(48, 613, 64, 25, 0, 1);
            //LODOP.ADD_PRINT_RECT(48, 676, 95, 25, 0, 1);

            LODOP.ADD_PRINT_RECT(48, 3, 76, 25, 0, 1);
            LODOP.ADD_PRINT_RECT(48, 78, 77, 25, 0, 1);
            LODOP.ADD_PRINT_RECT(48, 154, 90, 25, 0, 1);
            LODOP.ADD_PRINT_RECT(48, 243, 77, 25, 0, 1);
            LODOP.ADD_PRINT_RECT(48, 319, 60, 25, 0, 1);
            LODOP.ADD_PRINT_RECT(48, 378, 85, 25, 0, 1);
            LODOP.ADD_PRINT_RECT(48, 462, 50, 25, 0, 1);
            LODOP.ADD_PRINT_RECT(48, 511, 60, 25, 0, 1);
            LODOP.ADD_PRINT_RECT(48, 570, 90, 25, 0, 1);
            LODOP.ADD_PRINT_RECT(48, 659, 70, 25, 0, 1);
            LODOP.ADD_PRINT_TEXT(52, 5, 83, 25, "入库单号");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            LODOP.ADD_PRINT_TEXT(52, 81, 89, 25, "产品名称");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            LODOP.ADD_PRINT_TEXT(52, 165, 80, 25, "货品代码");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            LODOP.ADD_PRINT_TEXT(52, 263, 43, 25, "规格");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            LODOP.ADD_PRINT_TEXT(52, 326, 48, 25, "型号");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            LODOP.ADD_PRINT_TEXT(52, 394, 54, 25, "花纹");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            LODOP.ADD_PRINT_TEXT(52, 474, 45, 25, "批次");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            LODOP.ADD_PRINT_TEXT(52, 516, 67, 25, "入库件数");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            LODOP.ADD_PRINT_TEXT(52, 580, 75, 25, "货位代码");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            LODOP.ADD_PRINT_TEXT(52, 665, 66, 25, "所在区域");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            //LODOP.ADD_PRINT_TEXT(52, 5, 83, 25, "入库单号");
            //LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            //LODOP.ADD_PRINT_TEXT(52, 81, 89, 25, "产品名称");
            //LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            //LODOP.ADD_PRINT_TEXT(52, 165, 65, 25, "货品代码");
            //LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            //LODOP.ADD_PRINT_TEXT(52, 247, 43, 25, "规格");
            //LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            //LODOP.ADD_PRINT_TEXT(52, 297, 61, 25, "型号");
            //LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            //LODOP.ADD_PRINT_TEXT(52, 359, 54, 25, "花纹");
            //LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            //LODOP.ADD_PRINT_TEXT(52, 424, 45, 25, "批次");
            //LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            //LODOP.ADD_PRINT_TEXT(52, 466, 67, 25, "入库件数");
            //LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            //LODOP.ADD_PRINT_TEXT(52, 530, 75, 25, "货位代码");
            //LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            //LODOP.ADD_PRINT_TEXT(52, 620, 66, 25, "所在区域");
            //LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            //LODOP.ADD_PRINT_TEXT(52, 680, 95, 25, "所在仓库");
            //LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);

            var griddata = $('#dgPrintInCargo').datagrid('getRows');
            var js = 0, Alltotal = 0, AllPiece = 0;
            for (var i = 0; i < griddata.length; i++) {
                js++;
                var p = Number(griddata[i].Piece);

                //LODOP.ADD_PRINT_RECT(73 + i * 25, 3, 76, 25, 0, 1);
                //LODOP.ADD_PRINT_RECT(73 + i * 25, 78, 77, 25, 0, 1);
                //LODOP.ADD_PRINT_RECT(73 + i * 25, 154, 78, 25, 0, 1);
                //LODOP.ADD_PRINT_RECT(73 + i * 25, 231, 60, 25, 0, 1);
                //LODOP.ADD_PRINT_RECT(73 + i * 25, 291, 64, 25, 0, 1);
                //LODOP.ADD_PRINT_RECT(73 + i * 25, 354, 63, 25, 0, 1);
                //LODOP.ADD_PRINT_RECT(73 + i * 25, 416, 50, 25, 0, 1);
                //LODOP.ADD_PRINT_RECT(73 + i * 25, 465, 60, 25, 0, 1);
                //LODOP.ADD_PRINT_RECT(73 + i * 25, 524, 90, 25, 0, 1);
                //LODOP.ADD_PRINT_RECT(73 + i * 25, 613, 64, 25, 0, 1);
                //LODOP.ADD_PRINT_RECT(73 + i * 25, 676, 95, 25, 0, 1);


                LODOP.ADD_PRINT_RECT(73 + i * 25, 3, 76, 25, 0, 1);
                LODOP.ADD_PRINT_RECT(73 + i * 25, 78, 77, 25, 0, 1);
                LODOP.ADD_PRINT_RECT(73 + i * 25, 154, 90, 25, 0, 1);
                LODOP.ADD_PRINT_RECT(73 + i * 25, 243, 77, 25, 0, 1);
                LODOP.ADD_PRINT_RECT(73 + i * 25, 319, 60, 25, 0, 1);
                LODOP.ADD_PRINT_RECT(73 + i * 25, 378, 85, 25, 0, 1);
                LODOP.ADD_PRINT_RECT(73 + i * 25, 462, 50, 25, 0, 1);
                LODOP.ADD_PRINT_RECT(73 + i * 25, 511, 60, 25, 0, 1);
                LODOP.ADD_PRINT_RECT(73 + i * 25, 570, 90, 25, 0, 1);
                LODOP.ADD_PRINT_RECT(73 + i * 25, 659, 70, 25, 0, 1);

                LODOP.ADD_PRINT_TEXT(77 + i * 25, 5, 90, 25, griddata[i].InCargoID);//"入库单号"
                LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
                LODOP.ADD_PRINT_TEXT(77 + i * 25, 81, 89, 25, griddata[i].ProductName);//产品名称
                LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
                LODOP.ADD_PRINT_TEXT(77 + i * 25, 163, 90, 25, griddata[i].GoodsCode);//"货品代码");
                LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
                LODOP.ADD_PRINT_TEXT(77 + i * 25, 252, 80, 25, griddata[i].Specs);//规格 
                LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
                LODOP.ADD_PRINT_TEXT(77 + i * 25, 325, 65, 25, griddata[i].Model);//型号
                LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
                LODOP.ADD_PRINT_TEXT(77 + i * 25, 380, 87, 25, griddata[i].Figure);//花纹
                LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
                LODOP.ADD_PRINT_TEXT(77 + i * 25, 467, 45, 25, griddata[i].Batch);//花纹"批次");
                LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
                LODOP.ADD_PRINT_TEXT(77 + i * 25, 522, 67, 25, p);//"入库件数"
                LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
                LODOP.ADD_PRINT_TEXT(77 + i * 25, 577, 100, 25, griddata[i].ContainerCode);//货位代码
                LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
                LODOP.ADD_PRINT_TEXT(77 + i * 25, 666, 66, 25, griddata[i].AreaName);//所在区域
                LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
                //LODOP.ADD_PRINT_TEXT(77 + i * 25, 680, 95, 25, griddata[i].HouseName);//产品名称"所在仓库");
                //LODOP.SET_PRINT_STYLEA(0, "FontSize", 10);
            }
            LODOP.ADD_PRINT_TEXT(124 + (griddata.length - 1) * 25, 50, 102, 23, "仓库：");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 11);
            LODOP.ADD_PRINT_TEXT(124 + (griddata.length - 1) * 25, 337, 100, 20, "制表：");
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 11);
            LODOP.ADD_PRINT_TEXT(124 + (griddata.length - 1) * 25, 574, 200, 20, AllDateTime(nowdate));
            LODOP.SET_PRINT_STYLEA(0, "FontSize", 11);


            //LODOP.PRINT_DESIGN();
            LODOP.PREVIEW();
            updateInCargoPrintStatus();
        }
        //修改打印状态
        function updateInCargoPrintStatus() {
            var rows = $('#dgPrintInCargo').datagrid('getRows');
            if (rows == null || rows == "") { return; }
            var json = JSON.stringify(rows)
            $.ajax({
                url: 'productApi.aspx?method=updateInCargoPrintStatus',
                type: 'post', dataType: 'json', data: { data: json },
                success: function (text) { }
            });
        }
        //打印入库单
        function printCargoAwb() {
            $('#printInCargoAwb').dialog('open').dialog('setTitle', '打印入库单数据');
            //所在仓库
            $('#InID').combobox({
                url: '../House/houseApi.aspx?method=CargoPermisionHouse',
                valueField: 'HouseID', textField: 'Name',
                onSelect: function (rec) {
                    $('#InHID').combobox('clear');
                    var url = '../House/houseApi.aspx?method=QueryALLArea&pid=0&hid=' + rec.HouseID;
                    $('#InHID').combobox('reload', url);
                }
            });
            var houseId = "<%=UserInfor.HouseID%>";
            $("#InID").combobox("setValue", houseId);
            showPrintGrid();
            var datenow = new Date();
            $('#CStartDate').datebox('setValue', getLastDayFormatDate(datenow));
            $('#CEndDate').datebox('setValue', getNowFormatDate(datenow));
            $('#CIsPrintInCargo').combobox('textbox').bind('focus', function () { $('#CIsPrintInCargo').combobox('showPanel'); });
            $('#CInHouseType').combobox('textbox').bind('focus', function () { $('#CInHouseType').combobox('showPanel'); });
            $('#dgPrintInCargo').datagrid('loadData', { total: 0, rows: [] });
            //var gridOpts = $('#dgPrintInCargo').datagrid('options');
            //gridOpts.url = '../House/houseApi.aspx?method=QueryNoPrintInCargoAwbData';
        }

        //查询入库单数据
        function searchInCargoPrint() {
            var columns = [];
            if ($('#InID').combobox('getValue') == "47") {
                columns.push({ title: '入库单号', field: 'InCargoID', width: '80px' });
                columns.push({ title: '产品名称', field: 'ProductName', width: '100px' });
                columns.push({ title: '规格', field: 'Specs', width: '80px' });
                columns.push({ title: '分类名称', field: 'TypeName', width: '80px' });
                columns.push({ title: '商贸编码', field: 'Model', width: '60px' });
                columns.push({ title: '富添盛编码', field: 'GoodsCode', width: '100px' });
                columns.push({ title: '祺航编码', field: 'Size', width: '80px' });
                columns.push({ title: '批次', field: 'Batch', width: '80px' });
                columns.push({ title: '入库件数', field: 'Piece', width: '60px' });
                columns.push({ title: '货位代码', field: 'ContainerCode', width: '80px' });
                columns.push({
                    title: '货位类型', field: 'ContainerType', width: '60px',
                    formatter: function (val, row, index) { if (val == "RCK") { return "货架"; } else if (val == "ULD") { return "板"; } else if (val == "CAR") { return "拖车"; } else if (val == "SHL") { return "空地"; } else { return ""; } }
                });
                columns.push({ title: '所在区域', field: 'AreaName', width: '60px' });
                columns.push({ title: '一级区域', field: 'ParentAreaName', width: '60px' });
                columns.push({ title: '所在仓库', field: 'FirstAreaName', width: '80px' });
                columns.push({ title: '入库时间', field: 'InHouseTime', width: '120px', formatter: DateTimeFormatter });
            } else {
                columns.push({ title: '入库单号', field: 'InCargoID', width: '80px' });
                columns.push({ title: '产品名称', field: 'ProductName', width: '100px' });
                columns.push({ title: '分类名称', field: 'TypeName', width: '80px' });
                columns.push({ title: '型号', field: 'Model', width: '60px' });
                columns.push({ title: '货品代码', field: 'GoodsCode', width: '100px' });
                columns.push({ title: '规格', field: 'Specs', width: '80px' });
                columns.push({ title: '批次', field: 'Batch', width: '80px' });
                columns.push({ title: '入库件数', field: 'Piece', width: '60px' });
                columns.push({ title: '货位代码', field: 'ContainerCode', width: '80px' });
                columns.push({
                    title: '货位类型', field: 'ContainerType', width: '60px',
                    formatter: function (val, row, index) { if (val == "RCK") { return "货架"; } else if (val == "ULD") { return "板"; } else if (val == "CAR") { return "拖车"; } else if (val == "SHL") { return "空地"; } else { return ""; } }
                });
                columns.push({ title: '所在区域', field: 'AreaName', width: '60px' });
                columns.push({ title: '一级区域', field: 'ParentAreaName', width: '60px' });
                columns.push({ title: '所在仓库', field: 'FirstAreaName', width: '80px' });
                columns.push({ title: '入库时间', field: 'InHouseTime', width: '120px', formatter: DateTimeFormatter });
            }

            $('#dgPrintInCargo').datagrid('clearSelections');
            var gridOpts = $('#dgPrintInCargo').datagrid('options');
            gridOpts.url = '../House/houseApi.aspx?method=QueryNoPrintInCargoAwbData';
            $('#dgPrintInCargo').datagrid('load', {
                StartDate: $('#CStartDate').datebox('getValue'),
                EndDate: $('#CEndDate').datebox('getValue'),
                IsPrintInCargo: $("#CIsPrintInCargo").combobox('getValue'),
                InHouseType: $("#CInHouseType").combobox('getValue'),
                HouseID: $("#InID").combobox('getValue'),
                InHID: $("#InHID").combobox('getValue')
            });
            $('#dgPrintInCargo').datagrid({
                columns: [columns]
            })
        }


        //显示列表
        function showPrintGrid() {
            var columns = [];
            var HID = "<%=UserInfor.HouseID%>";
            if (HID == "47") {
                columns.push({ title: '入库单号', field: 'InCargoID', width: '80px' });
                columns.push({ title: '产品名称', field: 'ProductName', width: '100px' });
                columns.push({ title: '规格', field: 'Specs', width: '80px' });
                columns.push({ title: '分类名称', field: 'TypeName', width: '80px' });
                columns.push({ title: '商贸编码', field: 'Model', width: '60px' });
                columns.push({ title: '富添盛编码', field: 'GoodsCode', width: '100px' });
                columns.push({ title: '祺航编码', field: 'Size', width: '80px' });
                columns.push({ title: '批次', field: 'Batch', width: '80px' });
                columns.push({ title: '入库件数', field: 'Piece', width: '60px' });
                columns.push({ title: '货位代码', field: 'ContainerCode', width: '80px' });
                columns.push({
                    title: '货位类型', field: 'ContainerType', width: '60px',
                    formatter: function (val, row, index) { if (val == "RCK") { return "货架"; } else if (val == "ULD") { return "板"; } else if (val == "CAR") { return "拖车"; } else if (val == "SHL") { return "空地"; } else { return ""; } }
                });
                columns.push({ title: '所在区域', field: 'AreaName', width: '60px' });
                columns.push({ title: '一级区域', field: 'ParentAreaName', width: '60px' });
                columns.push({ title: '所在仓库', field: 'FirstAreaName', width: '80px' });
                columns.push({ title: '入库时间', field: 'InHouseTime', width: '120px', formatter: DateTimeFormatter });
            } else {
                columns.push({ title: '入库单号', field: 'InCargoID', width: '80px' });
                columns.push({ title: '产品名称', field: 'ProductName', width: '100px' });
                columns.push({ title: '分类名称', field: 'TypeName', width: '80px' });
                columns.push({ title: '型号', field: 'Model', width: '60px' });
                columns.push({ title: '货品代码', field: 'GoodsCode', width: '100px' });
                columns.push({ title: '规格', field: 'Specs', width: '80px' });
                columns.push({ title: '批次', field: 'Batch', width: '80px' });
                columns.push({ title: '入库件数', field: 'Piece', width: '60px' });
                columns.push({ title: '货位代码', field: 'ContainerCode', width: '80px' });
                columns.push({
                    title: '货位类型', field: 'ContainerType', width: '60px',
                    formatter: function (val, row, index) { if (val == "RCK") { return "货架"; } else if (val == "ULD") { return "板"; } else if (val == "CAR") { return "拖车"; } else if (val == "SHL") { return "空地"; } else { return ""; } }
                });
                columns.push({ title: '所在区域', field: 'AreaName', width: '60px' });
                columns.push({ title: '一级区域', field: 'ParentAreaName', width: '60px' });
                columns.push({ title: '所在仓库', field: 'FirstAreaName', width: '80px' });
                columns.push({ title: '入库时间', field: 'InHouseTime', width: '120px', formatter: DateTimeFormatter });
            }
            $('#dgPrintInCargo').datagrid({
                width: '100%',
                height: '400px',
                title: '', //标题内容
                rownumbers: true,
                loadMsg: '数据加载中请稍候...',
                autoRowHeight: false, //行高是否自动
                collapsible: false, //是否可折叠
                pagination: false, //分页是否显示
                fitColumns: false, //设置为 true，则会自动扩大或缩小列的尺寸以适应网格的宽度并且防止水平滚动
                singleSelect: false, //设置为 true，则只允许选中一行。
                checkOnSelect: true, //如果设置为 true，当用户点击某一行时，则会选中/取消选中复选框。如果设置为 false 时，只有当用户点击了复选框时，才会选中/取消选中复选框
                idField: 'ID',
                url: null,
                columns: [columns]
            });
        }

        //入库
        function inCargo() {
            //var row = $('#dg').datagrid('getSelections');
            var row = $('#dg').datagrid('getSelected');
            if (row == null || row == "") { $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '请选择要入库的数据！', 'warning'); return; }
            if (row.InCargoStatus == "1") {
                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '该产品已入库！', 'warning'); return;
            }
            var hproduct, hnum = 0, typeid = 0, productid = 0;
            if (row) {
                hproduct = row.ProductName;
                hnum += Number(row.Numbers);

                typeid = row.TypeID;
                productid = row.ProductID;
                $('#inCargo').dialog('open').dialog('setTitle', hproduct + ' 规格：' + row.Specs + ' 花纹：' + row.Figure + ' 产品入库');
                //所在仓库
                $('#HID').combobox({
                    url: '../House/houseApi.aspx?method=CargoPermisionHouse',
                    valueField: 'HouseID', textField: 'Name',
                    onSelect: function (rec) {
                        $('#AAHID').combobox('clear');
                        var url = '../House/houseApi.aspx?method=QueryALLArea&pid=0&hid=' + rec.HouseID;
                        $('#AAHID').combobox('reload', url);
                        //一级仓库
                        $('#AAHID').combobox({
                            onSelect: function (fai) {
                                $('#PID').combobox('clear');
                                var url = '../House/houseApi.aspx?method=QueryALLAreaRecur&hid=' + rec.HouseID + '&pid=' + fai.AreaID;
                                $('#PID').combobox('reload', url);
                            }
                        });
                    }
                });
                $('#HID').combobox('setValue', '<%=UserInfor.HouseID%>');
                $('#AAHID').combobox('clear');
                var url = '../House/houseApi.aspx?method=QueryALLArea&pid=0&hid=<%=UserInfor.HouseID%>';
                $('#AAHID').combobox('reload', url);
                //一级仓库
                $('#AAHID').combobox({
                    onSelect: function (fai) {
                        $('#PID').combobox('clear');
                        var url = '../House/houseApi.aspx?method=QueryALLAreaRecur&hid=<%=UserInfor.HouseID%>&pid=' + fai.AreaID;
                        $('#PID').combobox('reload', url);
                    }
                });
                $('#HProduct').textbox('setValue', hproduct);
                $('#HPiece').textbox('setValue', hnum);
                $('#YesPiece').textbox('setValue', 0);
                $('#NoPiece').textbox('setValue', hnum);
                $('#CProductID').val(productid);//产品ID
                $('#CTypeID').val(typeid);//产品类型ID
                $('#CModel').val(row.Model);//型号
                $('#CSpecs').val(row.Specs);//规模
                $('#CFigure').val(row.Figure);//花纹
                $('#CLoadIndex').val(row.LoadIndex);//载重指数
                $('#CSpeedLevel').val(row.SpeedLevel);//速度级别
                $('#CBatch').val(row.Batch);//批次
                $('#CSource').val(row.Source);//批次

                showGrid();
                $('#dgInCargo').datagrid('clearSelections');
                var gridOpts = $('#dgInCargo').datagrid('options');
                gridOpts.url = '../House/houseApi.aspx?method=QueryInContainerByProduct&TypeID=' + typeid + '&Specs=' + row.Specs + '&Figure=' + row.Figure;
            }
        }
        //查询
        function queryPosition() {
            $('#dgInCargo').datagrid('clearSelections');
            var gridOpts = $('#dgInCargo').datagrid('options');
            gridOpts.url = '../House/houseApi.aspx?method=QueryCargoContainer';
            $('#dgInCargo').datagrid('load', {
                ContainerCode: $('#CCode').val(),
                //ContainerType: $("#CType").combobox('getValue'),
                Star: "",
                TypeID: $('#CTypeID').val(),
                PID: $("#PID").combobox('getValue'),
                FirstID: $("#AAHID").combobox('getValue'),
                HID: $("#HID").combobox('getValue')
            });
        }

        //显示列表
        function showGrid() {
            $('#dgInCargo').datagrid({
                width: '100%',
                height: '285px',
                title: '该产品已在仓库货位', //标题内容
                rownumbers: true,
                loadMsg: '数据加载中请稍候...',
                autoRowHeight: false, //行高是否自动
                collapsible: false, //是否可折叠
                pagination: false, //分页是否显示
                fitColumns: false, //设置为 true，则会自动扩大或缩小列的尺寸以适应网格的宽度并且防止水平滚动
                singleSelect: false, //设置为 true，则只允许选中一行。
                checkOnSelect: true, //如果设置为 true，当用户点击某一行时，则会选中/取消选中复选框。如果设置为 false 时，只有当用户点击了复选框时，才会选中/取消选中复选框
                idField: 'ContainerID',
                url: null,
                columns: [[
                    { title: '星级', field: 'Star', width: '30px' },
                    { title: '货位代码', field: 'ContainerCode', width: '80px' },
                    {
                        title: '货位类型', field: 'ContainerType', width: '60px',
                        formatter: function (val, row, index) { if (val == "RCK") { return "货架"; } else if (val == "ULD") { return "板"; } else if (val == "CAR") { return "拖车"; } else if (val == "SHL") { return "空地"; } else { return ""; } }
                    },
                    { title: '拉上件数', field: 'OnPiece', width: '60px', editor: { type: 'numberbox', options: { min: 0, precision: 0 } } },
                    { title: '货位可拉件数', field: 'allowPiece', width: '60px' },
                    { title: '该产品在货位件数', field: 'ProductPiece', width: '100px' },
                    { title: '货位已有件数', field: 'InPiece', width: '60px' },
                    { title: '最大件数', field: 'MaxPiece', width: '60px' },
                    { title: '预警件数', field: 'WarnPiece', width: '60px' },
                    //{ title: '所在仓库', field: 'HouseName', width: '80px' },
                    { title: '一级区域', field: 'FirstAreaName', width: '80px' },
                    { title: '二级区域', field: 'AreaName', width: '80px' }
                ]],
                onClickCell: onClickCell,
                onLoadSuccess: function (data) { },
                onDblClickRow: function (index, row) { }
            });
        }

        $.extend($.fn.datagrid.methods, {
            editCell: function (jq, param) {
                return jq.each(function () {
                    var fields = $(this).datagrid('getColumnFields');
                    for (var i = 0; i < fields.length; i++) {
                        var col = $(this).datagrid('getColumnOption', fields[i]);
                        col.editor1 = col.editor;
                        if (fields[i] != param.field) {
                            col.editor = null;
                        }
                    }
                    $(this).datagrid('beginEdit', param.index);
                    for (var i = 0; i < fields.length; i++) {
                        var col = $(this).datagrid('getColumnOption', fields[i]);
                        col.editor = col.editor1;
                    }
                });
            }
        });

        var editIndex = undefined;
        function endEditing() {
            if (editIndex == undefined) { return true }
            if ($('#dgInCargo').datagrid('validateRow', editIndex)) {
                var rows = $("#dgInCargo").datagrid('getData').rows[editIndex];
                var ed = $('#dgInCargo').datagrid('getEditors', editIndex);
                var cg = ed[0];
                var sum = 0;
                var jian = 0;
                var HPiece = Number($('#HPiece').textbox('getValue'));
                var yP = $('#YesPiece').textbox('getValue') == null ? 0 : Number($('#YesPiece').textbox('getValue'));//已拉
                var nP = $('#NoPiece').textbox('getValue') == null ? 0 : Number($('#NoPiece').textbox('getValue'));//未拉
                //已拉件数加上，未拉件数减去,当已拉件数超过入库件数提示
                if (cg.field == "OnPiece") {
                    sum = Number(cg.target.val()) + Number(yP) - Number(cg.oldHtml);
                    jian = HPiece - sum;
                    if (sum > HPiece) {
                        $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '超过上架件数！', 'warning');
                        return false;
                    }
                    $('#YesPiece').textbox('setValue', sum);
                    $('#NoPiece').textbox('setValue', jian);
                }
                $('#dgInCargo').datagrid('endEdit', editIndex);
                editIndex = undefined;
                return true;
            } else {
                return false;
            }
        }
        function onClickCell(index, field) {
            var rows = $("#dgInCargo").datagrid('getData').rows[index]
            if (Number(rows.allowPiece) <= 0) {
                return;
            }
            if (field == "OnPiece") {
                if (endEditing()) {
                    $('#dgInCargo').datagrid('selectRow', index)
                        .datagrid('editCell', { index: index, field: field });
                    editIndex = index;
                }
            }
            else {
                if (editIndex == undefined) { return true }
                var rows = $("#dgInCargo").datagrid('getData').rows[editIndex];
                var ed = $('#dgInCargo').datagrid('getEditors', editIndex);
                var cg = ed[0];
                var sum = 0;
                var jian = 0;
                var HPiece = Number($('#HPiece').textbox('getValue'));
                var yP = $('#YesPiece').textbox('getValue') == null ? 0 : Number($('#YesPiece').textbox('getValue'));//已拉
                var nP = $('#NoPiece').textbox('getValue') == null ? 0 : Number($('#NoPiece').textbox('getValue'));//未拉
                //已拉件数加上，未拉件数减去,当已拉件数超过入库件数提示
                if (cg.field == "OnPiece") {
                    sum = Number(cg.target.val()) + Number(yP) - Number(cg.oldHtml);
                    jian = HPiece - sum;
                    if (sum > HPiece) {
                        $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '超过上架件数！', 'warning');
                        return;
                    } else {
                        $('#YesPiece').textbox('setValue', sum);
                        $('#NoPiece').textbox('setValue', jian);
                    }
                }
                $('#dgInCargo').datagrid('endEdit', editIndex);
                editIndex = undefined;
            }
        }
        function closeIncargoDialog() {
            editIndex = undefined;
            $('#inCargo').dialog('close');
        }
        ///保存产品入库
        function saveInCargo() {
            $('#dgInCargo').datagrid('acceptChanges')
            var row = $('#dgInCargo').datagrid('getRows');
            var count = 0;
            for (var i = 0; i < row.length; i++) {
                if (row[i].OnPiece != undefined) {
                    count += Number(row[i].OnPiece);
                }
            }
            if (Number($("#HProduct").val()) < Number(count)) {
                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '超过上架件数！', 'warning');
                editIndex = undefined;
                return;
            }
            $.messager.progress({ msg: '请稍后,正在保存中...' });
            var json = JSON.stringify(row)
            $('#fmCargo').form('submit', {
                url: '../House/houseApi.aspx?method=SaveProductInCargo',
                contentType: "application/json;charset=utf-8", dataType: "json",
                onSubmit: function (param) {
                    param.submitData = json;
                    return $(this).form('enableValidation').form('validate');
                },
                success: function (msg) {
                    $.messager.progress("close");
                    var result = eval('(' + msg + ')');
                    if (result.Result) {
                        $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '入库成功', 'warning');
                        closedgShowData();
                        editIndex = undefined;
                    } else { $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '入库失败：' + result.Message, 'warning'); }
                }
            })
            $.messager.progress("close");

            editIndex = undefined;
        }
        //关闭
        function closedgShowData() {
            $('#inCargo').dialog('close');
            $("#dg").datagrid('reload');
        }
        //新增产品信息
        function addItem() {
            $('#dlg').dialog('open').dialog('setTitle', '新增产品信息');
            $('#fm').form('clear');
            if ($('#AHouseID').combobox('getValue') == "47") {
                //富添盛仓库
                $('#lGoodsCode').html("富添盛编码:");
                $('#GoodsCode').textbox({ prompt: '请输入富添盛编码' });
                $('#lModel').html("商贸编码:");
                $('#Model').textbox({ prompt: '请输入商贸编码' });
                $('#lFigure').html("长和编码:");
                $('#Figure').textbox({ prompt: '请输入长和编码' });
                $('#lSize').html("祺航编码:");
                $('#Size').textbox({ prompt: '请输入祺航编码' });
                $('#lSalePrice').html("");
                $('#lTradePrice').html("成本价");
                $('#Y1').hide();
                $('#Y2').hide();
                $('#Y3').hide();
                $('#Y4').hide();
                $('#Y5').hide();
                $('#Y6').hide();
                $('#Y7').hide();
                //$('#Y8').hide();
                $('#Y9').hide();
                $('#Y10').hide();
                $('#Y11').hide();
                $('#Y12').hide();
                $('#Y13').hide();
                $('#Y15').hide();
                $('#Y17').hide();
                $('#Y18').show();
                $('#Y19').hide();
                $('#Y20').hide();
                $("#Figure").textbox('options').required = false;
                $("#Figure").textbox('textbox').validatebox('options').required = false;
                $("#Figure").textbox('validate');
                $("#Specs").textbox('options').required = false;
                $("#Specs").textbox('textbox').validatebox('options').required = false;
                $("#Specs").textbox('validate');
                $("#Model").textbox('options').required = false;
                $("#Model").textbox('textbox').validatebox('options').required = false;
                $("#Model").textbox('validate');
                $("#Source").textbox('options').required = false;
                $("#Source").textbox('textbox').validatebox('options').required = false;
                $("#Source").textbox('validate');

            }
            else if ($('#AHouseID').combobox('getValue') == "63") {
                //一二三汽配仓库
                $('#lGoodsCode').html("产品编码:");
                $('#GoodsCode').textbox({ prompt: '请输入产品编码' });

                $('#lUnitPrice').html("基准价");
                $('#lTradePrice').html("成本价");
                $('#Y1').hide();
                $('#Y2').hide();
                $('#Y3').hide();
                $('#Y4').hide();
                $('#Y5').hide();
                $('#Y6').hide();
                $('#Y7').hide();
                $('#Y8').hide();
                $('#Y9').hide();
                $('#Y10').hide();
                $('#Y11').hide();
                $('#Y12').hide();
                $('#Y15').hide();
                $('#Y19').hide();
                $('#Y20').hide();
                $('#Y22').hide();
                $('#Y23').hide();
                $('#Y25').hide();
                $('#Y26').hide();

                $('#Y17').show();
                $('#Y13').show();
                $('#Y18').hide();
                $('#Y24').show();


            }
            else {
                $('#Y1').show();
                $('#Y2').show();
                $('#Y3').show();
                $('#Y4').show();
                $('#Y5').show();
                $('#Y6').show();
                $('#Y7').show();
                $('#Y8').show();
                $('#Y9').show();
                $('#Y10').show();
                $('#Y11').show();
                $('#Y12').show();
                $('#Y13').show();
                $('#Y15').show();
                $('#Y17').show();
                $('#Y18').show();
                $('#Y19').show();
                $('#Y20').show();
                $("#Source").textbox('options').required = true;
                $("#Source").textbox('textbox').validatebox('options').required = true;
                $("#Source").textbox('validate');
                if ($('#AHouseID').combobox('getValue') == "64") {
                    $('#Y1').hide();
                    $('#Y2').hide();
                    $('#Y3').hide();
                    $('#Y4').hide();
                    $('#Y5').show();
                    $('#Y6').show();
                    $('#Y7').hide();
                    $('#Y8').hide();
                    $('#Y9').hide();
                    $('#Y10').hide();
                    $('#Y11').hide();
                    $('#Y12').hide();
                    $('#Y13').show();
                    $('#Y15').hide();
                    $('#Y17').hide();
                    $('#Y20').hide();
                    $('#Y21').hide();
                    $('#Y16').show();
                    $("#Source").combobox('options').required = false;
                    $("#Source").combobox('textbox').validatebox('options').required = false;
                    $("#Source").combobox('validate');
                    $("#ProductName").textbox('options').required = false;
                    $("#ProductName").textbox('textbox').validatebox('options').required = false;
                    $("#ProductName").textbox('validate');
                }
                $('#lTradePrice').html("门店价:");
                $('#lGoodsCode').html("货品代码:");
                $('#lModel').html("产品型号:");
                $('#lFigure').html("轮胎花纹:");
                //$('#lSpecs').html("规格:");
                //$('#Specs').textbox({ prompt: '请输入规格' });
                $('#Meridian').textbox('setValue', 'R');
                $('#btnSave').show();
                $('#Meridian').textbox('readonly', false);
                $('#TreadWidth').numberbox('readonly', false);
                $('#FlatRatio').numberbox('readonly', false);
                $('#HubDiameter').numberbox('readonly', false);
                $("#Figure").textbox('options').required = true;
                $("#Figure").textbox('textbox').validatebox('options').required = true;
                $("#Figure").textbox('validate');
                $("#Specs").textbox('options').required = true;
                $("#Specs").textbox('textbox').validatebox('options').required = true;
                $("#Specs").textbox('validate');
                $("#Model").textbox('options').required = true;
                $("#Model").textbox('textbox').validatebox('options').required = true;
                $("#Model").textbox('validate');

            }
            var SourceUrl = '../Product/productApi.aspx?method=QueryAllProductSource';
            $('#Source').combobox('reload', SourceUrl);
            $('#ParentID').combobox('readonly', false);
            $('#TypeID').combobox('readonly', false);
            $('#Specs').textbox('readonly', false);
            $('#Model').textbox('readonly', false);
            $('#GoodsCode').textbox('readonly', false);
            $('#Figure').textbox('readonly', false);
            $('#Batch').textbox('readonly', false);
            $('#SalePrice').numberbox('readonly', false);
            $('#TradePrice').numberbox('readonly', false);
            var SupplierUrl = '../Client/clientApi.aspx?method=QueryCargoClientSupplier&ClientType=4';
            $('#Supplier').combobox('reload', SupplierUrl);
        }
        //修改产品信息
        function editItem() {
            var row = $('#dg').datagrid('getSelected');
            if (row == null || row == "") {
                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '请选择要修改的数据！', 'warning');
                return;
            }
            if (row) {
                if (row.HouseID == 47) {
                    //富添盛仓库
                    $('#lGoodsCode').html("富添盛编码:");
                    $('#GoodsCode').textbox({ prompt: '请输入富添盛编码' });
                    $('#lModel').html("商贸编码:");
                    $('#Model').textbox({ prompt: '请输入商贸编码' });
                    $('#lFigure').html("长和编码:");
                    $('#Figure').textbox({ prompt: '请输入长和编码' });
                    $('#lSize').html("祺航编码:");
                    $('#Size').textbox({ prompt: '请输入祺航编码' });
                    $('#lSalePrice').html("");
                    $('#lTradePrice').html("成本价");
                    $('#Y1').hide();
                    $('#Y2').hide();
                    $('#Y3').hide();
                    $('#Y4').hide();
                    $('#Y5').hide();
                    $('#Y6').hide();
                    $('#Y7').hide();
                    //$('#Y8').hide();
                    $('#Y9').hide();
                    $('#Y10').hide();
                    $('#Y11').hide();
                    $('#Y12').hide();
                    $('#Y13').hide();
                    $('#Y15').hide();
                    $('#Y17').hide();
                    $('#Y18').show();
                    $('#Y19').hide();
                    $('#Y20').hide();
                    $('#ParentID').combobox('readonly', false);
                    $('#TypeID').combobox('readonly', false);
                    $('#Specs').textbox('readonly', false);
                    $('#Model').textbox('readonly', false);
                    //$('#GoodsCode').textbox('readonly', true);
                    $('#Figure').textbox('readonly', false);
                    $("#Figure").textbox('options').required = false;
                    $("#Figure").textbox('textbox').validatebox('options').required = false;
                    $("#Figure").textbox('validate');
                    $("#Specs").textbox('options').required = false;
                    $("#Specs").textbox('textbox').validatebox('options').required = false;
                    $("#Specs").textbox('validate');
                    $("#Model").textbox('options').required = false;
                    $("#Model").textbox('textbox').validatebox('options').required = false;
                    $("#Model").textbox('validate');
                }
                else if ($('#AHouseID').combobox('getValue') == "63") {
                    //一二三汽配仓库
                    $('#lGoodsCode').html("产品编码:");
                    $('#GoodsCode').textbox({ prompt: '请输入产品编码' });

                    $('#lUnitPrice').html("基准价");
                    $('#lTradePrice').html("成本价");
                    $('#Y1').hide();
                    $('#Y2').hide();
                    $('#Y3').hide();
                    $('#Y4').hide();
                    $('#Y5').hide();
                    $('#Y6').hide();
                    $('#Y7').hide();
                    $('#Y8').hide();
                    $('#Y9').hide();
                    $('#Y10').hide();
                    $('#Y11').hide();
                    $('#Y12').hide();
                    //$('#Y27').hide();
                    $('#Y15').hide();
                    $('#Y19').hide();
                    $('#Y20').hide();
                    $('#Y22').hide();
                    $('#Y23').hide();
                    $('#Y25').hide();
                    $('#Y26').hide();

                    $('#Y17').show();
                    $('#Y13').show();
                    $('#Y18').hide();
                    $('#Y24').show();
                    $("#Figure").textbox('options').required = false;
                    $("#Figure").textbox('textbox').validatebox('options').required = false;
                    $("#Figure").textbox('validate');
                    $("#Specs").textbox('options').required = false;
                    $("#Specs").textbox('textbox').validatebox('options').required = false;
                    $("#Specs").textbox('validate');
                    $("#Model").textbox('options').required = false;
                    $("#Model").textbox('textbox').validatebox('options').required = false;
                    $("#Model").textbox('validate');

                }
                else {
                    $('#Y1').show();
                    $('#Y2').show();
                    $('#Y3').show();
                    $('#Y4').show();
                    $('#Y5').show();
                    $('#Y6').show();
                    $('#Y7').show();
                    $('#Y8').show();
                    $('#Y9').show();
                    $('#Y10').show();
                    $('#Y11').show();
                    $('#Y12').show();
                    $('#Y13').show();
                    $('#Y15').show();
                    $('#Y17').show();
                    $('#Y18').show();
                    $('#Y19').show();
                    $('#Y20').show();
                    if ($('#AHouseID').combobox('getValue') == "64") {
                        $('#Y1').hide();
                        $('#Y2').hide();
                        $('#Y3').hide();
                        $('#Y4').hide();
                        $('#Y5').show();
                        $('#Y6').show();
                        $('#Y7').hide();
                        $('#Y8').hide();
                        $('#Y9').hide();
                        $('#Y10').hide();
                        $('#Y11').hide();
                        $('#Y12').hide();
                        $('#Y13').show();
                        $('#Y15').hide();
                        $('#Y17').hide();
                        $('#Y20').hide();
                        $('#Y21').hide();
                        $('#Y16').show();
                        $("#Source").combobox('options').required = false;
                        $("#Source").combobox('textbox').validatebox('options').required = false;
                        $("#Source").combobox('validate');
                        $("#ProductName").textbox('options').required = false;
                        $("#ProductName").textbox('textbox').validatebox('options').required = false;
                        $("#ProductName").textbox('validate');
                        $('#Supplier').textbox('setValue', row.Supplier);
                        $('#TradePrice').numberbox('readonly', false);
                        $('#SalePrice').numberbox('readonly', false);
                        $('#UnitPrice').numberbox('readonly', false);
                    }
                    $('#lGoodsCode').html("货品代码:");
                    $('#lModel').html("产品型号:");
                    $('#lFigure').html("轮胎花纹:");
                    $('#Meridian').textbox('setValue', 'R');
                    $('#btnSave').show();
                    $('#Meridian').textbox('readonly', false);
                    $('#TreadWidth').numberbox('readonly', false);
                    $('#FlatRatio').numberbox('readonly', false);
                    $('#HubDiameter').numberbox('readonly', false);

                    $('#ParentID').combobox('readonly', true);
                    $('#TypeID').combobox('readonly', true);
                    $('#Specs').textbox('readonly', true);
                    $('#Model').textbox('readonly', true);
                    //$('#GoodsCode').textbox('readonly', true);
                    $('#Figure').textbox('readonly', true);
                    $('#Meridian').textbox('readonly', true);
                    var hous = '<%= HouseName%>';
                    if (hous.indexOf("梅州") != -1) {
                        $('#Batch').textbox('readonly', false);
                    } else {
                        $('#Batch').textbox('readonly', true);
                    }
                    //$('#Batch').textbox('readonly', true);
                    $('#TreadWidth').numberbox('readonly', true);
                    $('#FlatRatio').numberbox('readonly', true);
                    $('#HubDiameter').numberbox('readonly', true);
                    //$('#SalePrice').numberbox('readonly', true);
                    //$('#TradePrice').numberbox('readonly', true);
                    $('#ParentID').combobox('setValue', row.ParentID);
                    $('#TypeID').combobox('setValue', row.TypeID);
                    $('#Born').combobox('setValue', row.Born);
                    $('#Assort').combobox('setValue', row.Assort);
                    $('#Supplier').textbox('setValue', row.Supplier);
                }
                $('#dlg').dialog('open').dialog('setTitle', '修改产品信息');
                //if (row.InCargoStatus == "1") {
                //    $('#btnSave').hide();
                //} else {
                //    $('#btnSave').show();
                //}
                $('#ParentID').combobox('clear');
                var url = 'productApi.aspx?method=QueryALLOneProductType';
                $('#ParentID').combobox('reload', url);

                $('#TypeID').combobox('clear');
                var url = 'productApi.aspx?method=QueryALLOneProductType&PID=' + row.ParentID;
                $('#TypeID').combobox('reload', url);
                var SourceUrl = '../Product/productApi.aspx?method=QueryAllProductSource';
                $('#Source').combobox('reload', SourceUrl);

                $('#ParentID').combobox('readonly', true);
                $('#TypeID').combobox('readonly', true);
                if (row.ParentID == "35" || row.ParentID == "10") {
                    $('#Specs').textbox('readonly', false);
                } else {
                    $('#Specs').textbox('readonly', true);
                }
                //$('#Model').textbox('readonly', true);
                //$('#GoodsCode').textbox('readonly', true);
                //$('#Figure').textbox('readonly', true);
                $('#Meridian').textbox('readonly', true);
                var hous = '<%= HouseName%>';
                if (hous.indexOf("梅州") != -1 || hous.indexOf("粤信广通") != -1) {
                    $('#Batch').textbox('readonly', false);
                } else {
                    $('#Batch').textbox('readonly', true);
                }
                //$('#Batch').textbox('readonly', true);
                $('#TreadWidth').numberbox('readonly', true);
                $('#FlatRatio').numberbox('readonly', true);
                $('#HubDiameter').numberbox('readonly', true);
                //$('#SalePrice').numberbox('readonly', true);
                //$('#TradePrice').numberbox('readonly', true);
                $('#ParentID').combobox('setValue', row.ParentID);
                $('#TypeID').combobox('setValue', row.TypeID);
                $('#Born').combobox('setValue', row.Born);
                $('#Assort').combobox('setValue', row.Assort);

                var SupplierUrl = '../Client/clientApi.aspx?method=QueryCargoClientSupplier&ClientType=4';
                $('#Supplier').combobox('reload', SupplierUrl);
                $("#Supplier").combobox('options').required = false;
                $("#Supplier").combobox('textbox').validatebox('options').required = false;
                $("#Supplier").combobox('validate');

                //$('#Supplier').textbox('setValue', row.Supplier);
                $('#fm').form('load', row);

            }
        }
        //修改产品信息
        function editItemByID(Did) {
            var row = $("#dg").datagrid('getData').rows[Did];
            if (row) {
                $('#dlg').dialog('open').dialog('setTitle', '修改产品信息');
                $('#ParentID').combobox('clear');
                var url = 'productApi.aspx?method=QueryALLOneProductType';
                $('#ParentID').combobox('reload', url);

                $('#TypeID').combobox('clear');
                var url = 'productApi.aspx?method=QueryALLOneProductType&PID=' + row.ParentID;
                $('#TypeID').combobox('reload', url);
                if (row.HouseID == 47) {
                    //富添盛仓库
                    $('#lGoodsCode').html("富添盛编码:");
                    $('#GoodsCode').textbox({ prompt: '请输入富添盛编码' });
                    $('#lModel').html("商贸编码:");
                    $('#Model').textbox({ prompt: '请输入商贸编码' });
                    $('#lFigure').html("长和编码:");
                    $('#Figure').textbox({ prompt: '请输入长和编码' });
                    $('#lSize').html("祺航编码:");
                    $('#Size').textbox({ prompt: '请输入祺航编码' });
                    $('#lSalePrice').html("");
                    $('#lTradePrice').html("成本价");
                    $('#Y1').hide();
                    $('#Y2').hide();
                    $('#Y3').hide();
                    $('#Y4').hide();
                    $('#Y5').hide();
                    $('#Y6').hide();
                    $('#Y7').hide();
                    //$('#Y8').hide();
                    $('#Y9').hide();
                    $('#Y10').hide();
                    $('#Y11').hide();
                    $('#Y12').hide();
                    $('#Y13').hide();
                    $('#Y15').hide();
                    $('#Y17').hide();
                    $('#Y18').show();
                    $('#Y19').hide();
                    $('#Y20').hide();
                    $('#ParentID').combobox('readonly', false);
                    $('#TypeID').combobox('readonly', false);
                    $('#Specs').textbox('readonly', false);
                    $('#Model').textbox('readonly', false);
                    //$('#GoodsCode').textbox('readonly', true);
                    $('#Figure').textbox('readonly', false);
                    $("#Figure").textbox('options').required = false;
                    $("#Figure").textbox('textbox').validatebox('options').required = false;
                    $("#Figure").textbox('validate');
                    $("#Specs").textbox('options').required = false;
                    $("#Specs").textbox('textbox').validatebox('options').required = false;
                    $("#Specs").textbox('validate');
                    $("#Model").textbox('options').required = false;
                    $("#Model").textbox('textbox').validatebox('options').required = false;
                    $("#Model").textbox('validate');
                }
                else if ($('#AHouseID').combobox('getValue') == "63") {
                    //一二三汽配仓库
                    $('#lGoodsCode').html("产品编码:");
                    $('#GoodsCode').textbox({ prompt: '请输入产品编码' });

                    $('#lUnitPrice').html("基准价");
                    $('#lTradePrice').html("成本价");
                    $('#Y1').hide();
                    $('#Y2').hide();
                    $('#Y3').hide();
                    $('#Y4').hide();
                    $('#Y5').hide();
                    $('#Y6').hide();
                    $('#Y7').hide();
                    $('#Y8').hide();
                    $('#Y9').hide();
                    $('#Y10').hide();
                    $('#Y11').hide();
                    $('#Y12').hide();
                    //$('#Y27').hide();
                    $('#Y15').hide();
                    $('#Y19').hide();
                    $('#Y20').hide();
                    $('#Y22').hide();
                    $('#Y23').hide();
                    $('#Y25').hide();
                    $('#Y26').hide();

                    $('#Y17').show();
                    $('#Y13').show();
                    $('#Y18').hide();
                    $('#Y24').show();

                    $("#Figure").textbox('options').required = false;
                    $("#Figure").textbox('textbox').validatebox('options').required = false;
                    $("#Figure").textbox('validate');
                    $("#Specs").textbox('options').required = false;
                    $("#Specs").textbox('textbox').validatebox('options').required = false;
                    $("#Specs").textbox('validate');
                    $("#Model").textbox('options').required = false;
                    $("#Model").textbox('textbox').validatebox('options').required = false;
                    $("#Model").textbox('validate');
                }
                else {
                    $('#Y1').show();
                    $('#Y2').show();
                    $('#Y3').show();
                    $('#Y4').show();
                    $('#Y5').show();
                    $('#Y6').show();
                    $('#Y7').show();
                    $('#Y8').show();
                    $('#Y9').show();
                    $('#Y10').show();
                    $('#Y11').show();
                    $('#Y12').show();
                    $('#Y13').show();
                    $('#Y15').show();
                    $('#Y17').show();
                    $('#Y18').show();
                    $('#Y19').show();
                    $('#Y20').show();
                    if ($('#AHouseID').combobox('getValue') == "64") {
                        $('#Y1').hide();
                        $('#Y2').hide();
                        $('#Y3').hide();
                        $('#Y4').hide();
                        $('#Y5').show();
                        $('#Y6').show();
                        $('#Y7').hide();
                        $('#Y8').hide();
                        $('#Y9').hide();
                        $('#Y10').hide();
                        $('#Y11').hide();
                        $('#Y12').hide();
                        $('#Y13').show();
                        $('#Y15').hide();
                        $('#Y17').hide();
                        $('#Y20').hide();
                        $('#Y21').hide();
                        $('#Y16').show();
                        $("#Source").combobox('options').required = false;
                        $("#Source").combobox('textbox').validatebox('options').required = false;
                        $("#Source").combobox('validate');
                        $("#ProductName").textbox('options').required = false;
                        $("#ProductName").textbox('textbox').validatebox('options').required = false;
                        $("#ProductName").textbox('validate');
                        $('#Supplier').textbox('setValue', row.Supplier);
                        $('#TradePrice').numberbox('readonly', false);
                        $('#SalePrice').numberbox('readonly', false);
                        $('#UnitPrice').numberbox('readonly', false);
                    }
                    //$('#Supplier').textbox('setValue', row.Supplier);
                    $('#lGoodsCode').html("货品代码:");
                    //$('#lSpecs').html("规格:");
                    $('#lModel').html("产品型号:");
                    $('#lFigure').html("轮胎花纹:");
                    $('#Meridian').textbox('setValue', 'R');
                    $('#btnSave').show();
                    $('#Meridian').textbox('readonly', false);
                    $('#TreadWidth').numberbox('readonly', false);
                    $('#FlatRatio').numberbox('readonly', false);
                    $('#HubDiameter').numberbox('readonly', false);

                    $('#ParentID').combobox('readonly', true);
                    $('#TypeID').combobox('readonly', true);
                    if (row.ParentID == "35" || row.ParentID == "10") {
                        $('#Specs').textbox('readonly', false);
                    } else {
                        $('#Specs').textbox('readonly', true);
                    }
                    //$('#Model').textbox('readonly', true);
                    //$('#GoodsCode').textbox('readonly', true);
                    //$('#Figure').textbox('readonly', true);
                    $('#Meridian').textbox('readonly', true);
                    var hous = '<%= HouseName%>';
                    if (hous.indexOf("梅州") != -1 || hous.indexOf("粤信广通") != -1) {
                        $('#Batch').textbox('readonly', false);
                    } else {
                        $('#Batch').textbox('readonly', true);
                    }
                    //$('#Batch').textbox('readonly', true);
                    $('#TreadWidth').numberbox('readonly', true);
                    $('#FlatRatio').numberbox('readonly', true);
                    $('#HubDiameter').numberbox('readonly', true);
                    //$('#SalePrice').numberbox('readonly', true);
                    //$('#TradePrice').numberbox('readonly', true);
                    $('#ParentID').combobox('setValue', row.ParentID);
                    $('#TypeID').combobox('setValue', row.TypeID);
                    $('#Born').combobox('setValue', row.Born);
                    $('#Assort').combobox('setValue', row.Assort);
                    $('#BelongDepart').combobox('setValue', row.BelongDepart);
                }


                var SourceUrl = '../Product/productApi.aspx?method=QueryAllProductSource';
                $('#Source').combobox('reload', SourceUrl);
                var SupplierUrl = '../Client/clientApi.aspx?method=QueryCargoClientSupplier&ClientType=4';
                $('#Supplier').combobox('reload', SupplierUrl);
                $('#Supplier').combobox('setValue', row.SuppClientNum);
                //$('#Supplier').textbox('setValue', row.Supplier);

                $('#fm').form('load', row);
            }
        }
        //删除产品信息
        function DelItem() {
            var rows = $('#dg').datagrid('getSelections');
            if (rows == null || rows == "") {
                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '请选择要删除的数据！', 'warning');
                return;
            }
            $.messager.confirm('<%= Cargo.Common.GetSystemNameAndVersion()%>', '确定删除该产品？', function (r) {
                if (r) {
                    var json = JSON.stringify(rows)
                    $.ajax({
                        url: 'productApi.aspx?method=DelCargoProduct',
                        type: 'post', dataType: 'json', data: { data: json },
                        success: function (text) {
                            //var result = eval('(' + msg + ')');
                            if (text.Result == true) {
                                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '删除成功!', 'info');
                                $('#dg').datagrid('reload');
                            }
                            else {
                                $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', text.Message, 'warning');
                            }
                        }
                    });
                }
            });
        }

        //保存产品信息
        function saveItem() {
            var TypeID = $('#TypeID').combobox('getValue');
            if (TypeID == "34") {
                var GoodsCode = $('#GoodsCode').textbox('getValue');
                if (GoodsCode.length != 11) {
                    $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '马牌货品代码要求11位!', 'warning');
                    return;
                }
            }
            var CHID = "<%=UserInfor.HouseID%>";
            var ParentID = $('#ParentID').combobox('getValue');
            if (CHID == "9" && ParentID == "1") {
            //广州仓库，轮胎类型
                <%--var ABelongDepart = $('#BelongDepart').combobox('getValue');
                if (ABelongDepart == undefined || ABelongDepart == "") {
                    $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '请选择归属部门!', 'warning');
                    return;
                }--%>
            }
            $.messager.progress({ msg: '请稍后,正在保存中...' });
            $('#fm').form('submit', {
                url: 'productApi.aspx?method=SaveCargoProduct',
                onSubmit: function () {
                    var check = $(this).form('enableValidation').form('validate');
                    if (!check) { $.messager.progress("close"); }
                    return check;
                },
                success: function (msg) {
                    $.messager.progress("close");
                    var result = eval('(' + msg + ')');
                    if (result.Result) {
                        $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '保存成功!', 'info');
                        $('#dlg').dialog('close'); 	// close the dialog
                        dosearch();
                    } else {
                        $.messager.alert('<%= Cargo.Common.GetSystemNameAndVersion()%>', '保存失败：' + result.Message, 'warning');
                    }
                }
            })
        }

        $(function () {
            $('#BelongMonth').datebox({
                //显示日趋选择对象后再触发弹出月份层的事件，初始化时没有生成月份层
                onShowPanel: function () {
                    //触发click事件弹出月份层
                    span.trigger('click');
                    if (!tds)
                        //延时触发获取月份对象，因为上面的事件触发和对象生成有时间间隔
                        setTimeout(function () {
                            tds = p.find('div.calendar-menu-month-inner td');
                            tds.click(function (e) {
                                //禁止冒泡执行easyui给月份绑定的事件
                                e.stopPropagation();
                                //得到年份
                                var year = /\d{4}/.exec(span.html())[0],
                                    //月份
                                    //之前是这样的month = parseInt($(this).attr('abbr'), 10) + 1; 
                                    month = parseInt($(this).attr('abbr'), 10);

                                //隐藏日期对象                     
                                $('#BelongMonth').datebox('hidePanel').datebox('setValue', year + '-' + month);
                            });
                        }, 0);
                },
                //配置parser，返回选择的日期
                parser: function (s) {
                    if (!s) return new Date();
                    var arr = s.split('-');
                    return new Date(parseInt(arr[0], 10), parseInt(arr[1], 10) - 1, 1);
                },
                //配置formatter，只返回年月 之前是这样的d.getFullYear() + '-' +(d.getMonth()); 
                formatter: function (d) {
                    var currentMonth = (d.getMonth() + 1);
                    var currentMonthStr = currentMonth < 10 ? ('0' + currentMonth) : (currentMonth + '');
                    return d.getFullYear() + '-' + currentMonthStr;
                }
            });
            //日期选择对象
            var p = $('#BelongMonth').datebox('panel'),
                //日期选择对象中月份
                tds = false,
                //显示月份层的触发控件
                span = p.find('span.calendar-text');

        });
        $(function () {
            $('#ABelongMonth').datebox({
                //显示日趋选择对象后再触发弹出月份层的事件，初始化时没有生成月份层
                onShowPanel: function () {
                    //触发click事件弹出月份层
                    span.trigger('click');
                    if (!btds)
                        //延时触发获取月份对象，因为上面的事件触发和对象生成有时间间隔
                        setTimeout(function () {
                            btds = p.find('div.calendar-menu-month-inner td');
                            btds.click(function (e) {
                                //禁止冒泡执行easyui给月份绑定的事件
                                e.stopPropagation();
                                //得到年份
                                var year = /\d{4}/.exec(span.html())[0],
                                    //月份
                                    //之前是这样的month = parseInt($(this).attr('abbr'), 10) + 1; 
                                    month = parseInt($(this).attr('abbr'), 10);

                                //隐藏日期对象                     
                                $('#ABelongMonth').datebox('hidePanel').datebox('setValue', year + '-' + month);
                            });
                        }, 0);
                },
                //配置parser，返回选择的日期
                parser: function (s) {
                    if (!s) return new Date();
                    var arr = s.split('-');
                    return new Date(parseInt(arr[0], 10), parseInt(arr[1], 10) - 1, 1);
                },
                //配置formatter，只返回年月 之前是这样的d.getFullYear() + '-' +(d.getMonth()); 
                formatter: function (d) {
                    var currentMonth = (d.getMonth() + 1);
                    var currentMonthStr = currentMonth < 10 ? ('0' + currentMonth) : (currentMonth + '');
                    return d.getFullYear() + '-' + currentMonthStr;
                }
            });
            //日期选择对象
            var p = $('#ABelongMonth').datebox('panel'),
                //日期选择对象中月份
                btds = false,
                //显示月份层的触发控件
                span = p.find('span.calendar-text');
        });
        //格式化日期
        function myformatter(date) {
            //获取年份
            var y = date.getFullYear();
            //获取月份
            var m = date.getMonth();
            return y + '-' + m;
        }
    </script>
</asp:Content>
